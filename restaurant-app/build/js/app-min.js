navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("*** Service Worker registered ***")}).catch(function(e){console.log(e)}),function(){function e(e){return new Promise(function(t,r){e.onsuccess=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function t(t,r,n){var o,a=new Promise(function(a,s){e(o=t[r].apply(t,n)).then(a,s)});return a.request=o,a}function r(e,t,r){r.forEach(function(r){Object.defineProperty(e.prototype,r,{get:function(){return this[t][r]},set:function(e){this[t][r]=e}})})}function n(e,r,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return t(this[r],o,arguments)})})}function o(e,t,r,n){n.forEach(function(n){n in r.prototype&&(e.prototype[n]=function(){return this[t][n].apply(this[t],arguments)})})}function a(e,r,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return e=this[r],(n=t(e,o,arguments)).then(function(e){if(e)return new i(e,n.request)});var e,n})})}function s(e){this._index=e}function i(e,t){this._cursor=e,this._request=t}function c(e){this._store=e}function u(e){this._tx=e,this.complete=new Promise(function(t,r){e.oncomplete=function(){t()},e.onerror=function(){r(e.error)},e.onabort=function(){r(e.error)}})}function l(e,t,r){this._db=e,this.oldVersion=t,this.transaction=new u(r)}function p(e){this._db=e}r(s,"_index",["name","keyPath","multiEntry","unique"]),n(s,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(s,"_index",IDBIndex,["openCursor","openKeyCursor"]),r(i,"_cursor",["direction","key","primaryKey","value"]),n(i,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(i.prototype[t]=function(){var r=this,n=arguments;return Promise.resolve().then(function(){return r._cursor[t].apply(r._cursor,n),e(r._request).then(function(e){if(e)return new i(e,r._request)})})})}),c.prototype.createIndex=function(){return new s(this._store.createIndex.apply(this._store,arguments))},c.prototype.index=function(){return new s(this._store.index.apply(this._store,arguments))},r(c,"_store",["name","keyPath","indexNames","autoIncrement"]),n(c,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),a(c,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(c,"_store",IDBObjectStore,["deleteIndex"]),u.prototype.objectStore=function(){return new c(this._tx.objectStore.apply(this._tx,arguments))},r(u,"_tx",["objectStoreNames","mode"]),o(u,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new c(this._db.createObjectStore.apply(this._db,arguments))},r(l,"_db",["name","version","objectStoreNames"]),o(l,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new u(this._db.transaction.apply(this._db,arguments))},r(p,"_db",["name","version","objectStoreNames"]),o(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[c,s].forEach(function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t,r=(t=arguments,Array.prototype.slice.call(t)),n=r[r.length-1],o=this._store||this._index,a=o[e].apply(o,r.slice(0,-1));a.onsuccess=function(){n(a.result)}})})}),[s,c].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var r=this,n=[];return new Promise(function(o){r.iterateCursor(e,function(e){e?(n.push(e.value),void 0===t||n.length!=t?e.continue():o(n)):o(n)})})})});var h={open:function(e,r,n){var o=t(indexedDB,"open",[e,r]),a=o.request;return a&&(a.onupgradeneeded=function(e){n&&n(new l(a.result,e.oldVersion,a.transaction))}),o.then(function(e){return new p(e)})},delete:function(e){return t(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=h,module.exports.default=module.exports):self.idb=h}();var API_URL="http://localhost:1337/restaurants",fetchStatus=0,reviewsFetchStatus=0,DB_VERSION=2;class IDbOperationsHelper{static checkForIDbSupport(){return"indexedDB"in window?1:0}static openIDb(e,t,r){return idb.open(e,t,e=>{e.createObjectStore(r,{autoIncrement:!0})})}static addToDb(e,t,r,n){e.then(e=>{var o=e.transaction(t,r);return o.objectStore(t).put(n),o.complete}).then(e=>(console.log("Data saved to IDB"),e)).catch(e=>e)}static getAllData(e,t,r){e.then(e=>e.transaction(t).objectStore(r).getAll()).then(e=>{IDbOperationsHelper.setRestaurantsData(e)})}static getDataFromServer(e,t,r,n){fetch(API_URL).then(e=>e.json()).then(o=>{o.forEach(e=>{e=IDbOperationsHelper.addMissingData(e)}),1!=fetchStatus&&(fetchStatus=1,o.forEach(n=>{IDbOperationsHelper.addToDb(e,t,r,n)})),n(null,o)}).catch(e=>{n(e,null)})}static getRestaurantsData(e){var t=DB_VERSION,r=IDbOperationsHelper.openIDb("restaurants-data",t,"restaurants");r.then(e=>e.transaction("restaurants").objectStore("restaurants").getAll()).then(t=>{t.length<=0?IDbOperationsHelper.getDataFromServer(r,"restaurants","readwrite",e):e(null,t)})}static updateRestaurantData(e){var t=DB_VERSION;IDbOperationsHelper.openIDb("restaurants-data",t,"restaurants").then(t=>t.transaction("restaurants","readwrite").objectStore("restaurants").put(e)).then(e=>{console.log("test success"),console.log(e)}).catch(e=>{console.log("test failed"),console.log(e)})}static addMissingData(e){return isNaN(e.photograph)?e.photograph=e.id+".jpg":e.photograph=e.photograph+".jpg",e}static getReviewsFromServer(e,t,r,n){fetch("http://localhost:1337/reviews/").then(e=>e.json()).then(o=>{1!=reviewsFetchStatus&&(reviewsFetchStatus=1,o.forEach(n=>{IDbOperationsHelper.addToDb(e,t,r,n)})),n(null,o)}).catch(e=>{n(e,null)})}static getReviewsData(e){var t=DB_VERSION,r=IDbOperationsHelper.openIDb("reviews-data",t,"reviews");r.then(e=>e.transaction("reviews","readwrite").objectStore("reviews").getAll()).then(t=>{t.length<=0?IDbOperationsHelper.getReviewsFromServer(r,"reviews","readwrite",e):e(null,t)}).catch(t=>{e(t,null)})}static addReviewToIdb(e){var t=DB_VERSION,r=IDbOperationsHelper.openIDb("reviews-data",t,"reviews");IDbOperationsHelper.addToDb(r,"reviews","readwrite",e)}}class DBHelper{static get NEW_URL(){return"http://localhost:1337/restaurants"}static fetchRestaurantById(e,t){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)t(r,null);else{const r=n.find(t=>t.id==e);r?t(null,r):t("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(e,t){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)t(r,null);else{const r=n.filter(t=>t.cuisine_type==e);t(null,r)}})}static fetchRestaurantByNeighborhood(e,t){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)t(r,null);else{const r=n.filter(t=>t.neighborhood==e);t(null,r)}})}static fetchRestaurantByCuisineAndNeighborhood(e,t,r){IDbOperationsHelper.getRestaurantsData((n,o)=>{if(n)r(n,null);else{let n=o;"all"!=e&&(n=n.filter(t=>t.cuisine_type==e)),"all"!=t&&(n=n.filter(e=>e.neighborhood==t)),r(null,n)}})}static fetchNeighborhoods(e){IDbOperationsHelper.getRestaurantsData((t,r)=>{if(t)e(t,null);else{const t=r.map((e,t)=>r[t].neighborhood),n=t.filter((e,r)=>t.indexOf(e)==r);e(null,n)}})}static fetchCuisines(e){IDbOperationsHelper.getRestaurantsData((t,r)=>{if(t)e(t,null);else{const t=r.map((e,t)=>r[t].cuisine_type),n=t.filter((e,r)=>t.indexOf(e)==r);e(null,n)}})}static urlForRestaurant(e){return`./restaurant.html?id=${e.id}`}static imageUrlForRestaurant(e){return`/img/${e.photograph}`}static mapMarkerForRestaurant(e,t){const r=new L.marker([e.latlng.lat,e.latlng.lng],{title:e.name,alt:e.name,url:DBHelper.urlForRestaurant(e)});return r.addTo(newMap),r}static fetchReviewsForRestaurant(e,t){IDbOperationsHelper.getReviewsData((r,n)=>{if(r)t(r,null);else{let r=n.filter(t=>t.restaurant_id==e);r?t(null,r):t("Review does not exist",null)}})}static addReviewForRestaurant(e,t){IDbOperationsHelper.addReviewToIdb(e),t("Review added to IDB")}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4Q29udHJvbGxlci5qcyIsImlkYi5qcyIsIklEYk9wZXJhdGlvbnNIZWxwZXIuanMiLCJkYmhlbHBlci5qcyJdLCJuYW1lcyI6WyJuYXZpZ2F0b3IiLCJzZXJ2aWNlV29ya2VyIiwicmVnaXN0ZXIiLCJ0aGVuIiwicmVnIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyIiwicHJvbWlzaWZ5UmVxdWVzdCIsInJlcXVlc3QiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uc3VjY2VzcyIsInJlc3VsdCIsIm9uZXJyb3IiLCJlcnJvciIsInByb21pc2lmeVJlcXVlc3RDYWxsIiwib2JqIiwibWV0aG9kIiwiYXJncyIsInAiLCJhcHBseSIsInByb3h5UHJvcGVydGllcyIsIlByb3h5Q2xhc3MiLCJ0YXJnZXRQcm9wIiwicHJvcGVydGllcyIsImZvckVhY2giLCJwcm9wIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b3R5cGUiLCJnZXQiLCJ0aGlzIiwic2V0IiwidmFsIiwicHJveHlSZXF1ZXN0TWV0aG9kcyIsIkNvbnN0cnVjdG9yIiwiYXJndW1lbnRzIiwicHJveHlNZXRob2RzIiwicHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyIsInZhbHVlIiwiQ3Vyc29yIiwiSW5kZXgiLCJpbmRleCIsIl9pbmRleCIsImN1cnNvciIsIl9jdXJzb3IiLCJfcmVxdWVzdCIsIk9iamVjdFN0b3JlIiwic3RvcmUiLCJfc3RvcmUiLCJUcmFuc2FjdGlvbiIsImlkYlRyYW5zYWN0aW9uIiwiX3R4IiwiY29tcGxldGUiLCJvbmNvbXBsZXRlIiwib25hYm9ydCIsIlVwZ3JhZGVEQiIsImRiIiwib2xkVmVyc2lvbiIsInRyYW5zYWN0aW9uIiwiX2RiIiwiREIiLCJJREJJbmRleCIsIklEQkN1cnNvciIsIm1ldGhvZE5hbWUiLCJjcmVhdGVJbmRleCIsIklEQk9iamVjdFN0b3JlIiwib2JqZWN0U3RvcmUiLCJJREJUcmFuc2FjdGlvbiIsImNyZWF0ZU9iamVjdFN0b3JlIiwiSURCRGF0YWJhc2UiLCJmdW5jTmFtZSIsInJlcGxhY2UiLCJhcnIiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsImNhbGxiYWNrIiwibGVuZ3RoIiwibmF0aXZlT2JqZWN0IiwiZ2V0QWxsIiwicXVlcnkiLCJjb3VudCIsImluc3RhbmNlIiwiaXRlbXMiLCJpdGVyYXRlQ3Vyc29yIiwicHVzaCIsInVuZGVmaW5lZCIsImNvbnRpbnVlIiwiZXhwIiwib3BlbiIsIm5hbWUiLCJ2ZXJzaW9uIiwidXBncmFkZUNhbGxiYWNrIiwiaW5kZXhlZERCIiwib251cGdyYWRlbmVlZGVkIiwiZXZlbnQiLCJkZWxldGUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZGVmYXVsdCIsInNlbGYiLCJpZGIiLCJBUElfVVJMIiwiZmV0Y2hTdGF0dXMiLCJyZXZpZXdzRmV0Y2hTdGF0dXMiLCJEQl9WRVJTSU9OIiwiSURiT3BlcmF0aW9uc0hlbHBlciIsIltvYmplY3QgT2JqZWN0XSIsIndpbmRvdyIsIm9iamVjdFN0b3JlTmFtZSIsInVwZ3JhZGVEQiIsImF1dG9JbmNyZW1lbnQiLCJkYlByb21pc2UiLCJwZXJtaXNpb24iLCJqc29uRGF0YSIsInRyYW5zYWN0IiwicHV0IiwicmVzcG9uc2UiLCJ0cmFuc2FjdGlvbk5hbWUiLCJhcnJ5Iiwic2V0UmVzdGF1cmFudHNEYXRhIiwiZmV0Y2giLCJqc29uIiwicmVzcG9uc2VKc29uIiwicmVzdGF1cmFudCIsImFkZE1pc3NpbmdEYXRhIiwicmVzdGF1cmFudERhdGEiLCJhZGRUb0RiIiwiZGJWZXJzaW9uIiwib3BlbklEYiIsInJlc3BvbnNlT2JlamN0cyIsImdldERhdGFGcm9tU2VydmVyIiwicmVzIiwicmVzdEpzb24iLCJpc05hTiIsInBob3RvZ3JhcGgiLCJpZCIsImdldFJldmlld3NGcm9tU2VydmVyIiwicmV2aWV3RGF0YSIsIkRCSGVscGVyIiwiTkVXX1VSTCIsImdldFJlc3RhdXJhbnRzRGF0YSIsInJlc3RhdXJhbnRzIiwiZmluZCIsInIiLCJjdWlzaW5lIiwicmVzdWx0cyIsImZpbHRlciIsImN1aXNpbmVfdHlwZSIsIm5laWdoYm9yaG9vZCIsIm5laWdoYm9yaG9vZHMiLCJtYXAiLCJ2IiwiaSIsInVuaXF1ZU5laWdoYm9yaG9vZHMiLCJpbmRleE9mIiwiY3Vpc2luZXMiLCJ1bmlxdWVDdWlzaW5lcyIsIm1hcmtlciIsIkwiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ0aXRsZSIsImFsdCIsInVybCIsInVybEZvclJlc3RhdXJhbnQiLCJhZGRUbyIsIm5ld01hcCIsInJlc3RhdXJhbnRfaWQiLCJnZXRSZXZpZXdzRGF0YSIsImFsbFJldmlld3MiLCJyZXZpZXdzIiwiYWRkUmV2aWV3VG9JZGIiXSwibWFwcGluZ3MiOiJBQUFJQSxVQUFVQyxlQUNiRCxVQUFVQyxjQUFjQyxTQUFTLFVBQVVDLEtBQUtDLElBQy9DQyxRQUFRQyxJQUFJLHVDQUNWQyxNQUFNLFNBQVNDLEdBQ2pCSCxRQUFRQyxJQUFJRSxLQU1iLFdBS0EsU0FBU0MsRUFBaUJDLEdBQ3pCLE9BQU8sSUFBSUMsUUFBUSxTQUFTQyxFQUFTQyxHQUNwQ0gsRUFBUUksVUFBWSxXQUNuQkYsRUFBUUYsRUFBUUssU0FHakJMLEVBQVFNLFFBQVUsV0FDakJILEVBQU9ILEVBQVFPLFVBS2xCLFNBQVNDLEVBQXFCQyxFQUFLQyxFQUFRQyxHQUMxQyxJQUFJWCxFQUNBWSxFQUFJLElBQUlYLFFBQVEsU0FBU0MsRUFBU0MsR0FFckNKLEVBREFDLEVBQVVTLEVBQUlDLEdBQVFHLE1BQU1KLEVBQUtFLElBQ1BsQixLQUFLUyxFQUFTQyxLQUl6QyxPQURBUyxFQUFFWixRQUFVQSxFQUNMWSxFQVdSLFNBQVNFLEVBQWdCQyxFQUFZQyxFQUFZQyxHQUNoREEsRUFBV0MsUUFBUSxTQUFTQyxHQUMzQkMsT0FBT0MsZUFBZU4sRUFBV08sVUFBV0gsRUFBTSxDQUNqREksSUFBSyxXQUNKLE9BQU9DLEtBQUtSLEdBQVlHLElBRXpCTSxJQUFLLFNBQVNDLEdBQ2JGLEtBQUtSLEdBQVlHLEdBQVFPLE9BTTdCLFNBQVND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SCxHQUFLQSxFQUFFeUIsZUFBaUJBLEdBQ3BERyxFQUNIaEcsRUFBUyxLQUFNZ0csR0FFZmhHLEVBQVMsd0JBQXlCLFNBT3RDK0IsOEJBQThCK0IsRUFBWTlELEdBQ3pDOEIsb0JBQW9CbUUsZUFBZW5DLEdBQ25DOUQsRUFBUyIsInNvdXJjZXNDb250ZW50IjpbImlmIChuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcikge1xuXHRuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcignL3N3LmpzJykudGhlbihyZWcgPT4ge1xuXHRcdGNvbnNvbGUubG9nKCcqKiogU2VydmljZSBXb3JrZXIgcmVnaXN0ZXJlZCAqKionKTtcblx0fSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cdFx0Y29uc29sZS5sb2coZXJyKTtcblx0fSk7XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbigpIHtcblx0ZnVuY3Rpb24gdG9BcnJheShhcnIpIHtcblx0XHRyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJlc29sdmUocmVxdWVzdC5yZXN1bHQpO1xuXHRcdFx0fTtcblxuXHRcdFx0cmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJlamVjdChyZXF1ZXN0LmVycm9yKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuXHRcdHZhciByZXF1ZXN0O1xuXHRcdHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRyZXF1ZXN0ID0gb2JqW21ldGhvZF0uYXBwbHkob2JqLCBhcmdzKTtcblx0XHRcdHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuXHRcdH0pO1xuXG5cdFx0cC5yZXF1ZXN0ID0gcmVxdWVzdDtcblx0XHRyZXR1cm4gcDtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG5cdFx0dmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncyk7XG5cdFx0cmV0dXJuIHAudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0aWYgKCF2YWx1ZSkgcmV0dXJuO1xuXHRcdFx0cmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIHAucmVxdWVzdCk7XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm94eVByb3BlcnRpZXMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgcHJvcGVydGllcykge1xuXHRcdHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlDbGFzcy5wcm90b3R5cGUsIHByb3AsIHtcblx0XHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c2V0OiBmdW5jdGlvbih2YWwpIHtcblx0XHRcdFx0XHR0aGlzW3RhcmdldFByb3BdW3Byb3BdID0gdmFsO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb3h5UmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcblx0XHRwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuXHRcdFx0aWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG5cdFx0XHRQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcblx0XHRwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuXHRcdFx0aWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG5cdFx0XHRQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXS5hcHBseSh0aGlzW3RhcmdldFByb3BdLCBhcmd1bWVudHMpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcblx0XHRwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuXHRcdFx0aWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG5cdFx0XHRQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBJbmRleChpbmRleCkge1xuXHRcdHRoaXMuX2luZGV4ID0gaW5kZXg7XG5cdH1cblxuXHRwcm94eVByb3BlcnRpZXMoSW5kZXgsICdfaW5kZXgnLCBbXG5cdFx0J25hbWUnLFxuXHRcdCdrZXlQYXRoJyxcblx0XHQnbXVsdGlFbnRyeScsXG5cdFx0J3VuaXF1ZSdcblx0XSk7XG5cblx0cHJveHlSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG5cdFx0J2dldCcsXG5cdFx0J2dldEtleScsXG5cdFx0J2dldEFsbCcsXG5cdFx0J2dldEFsbEtleXMnLFxuXHRcdCdjb3VudCdcblx0XSk7XG5cblx0cHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG5cdFx0J29wZW5DdXJzb3InLFxuXHRcdCdvcGVuS2V5Q3Vyc29yJ1xuXHRdKTtcblxuXHRmdW5jdGlvbiBDdXJzb3IoY3Vyc29yLCByZXF1ZXN0KSB7XG5cdFx0dGhpcy5fY3Vyc29yID0gY3Vyc29yO1xuXHRcdHRoaXMuX3JlcXVlc3QgPSByZXF1ZXN0O1xuXHR9XG5cblx0cHJveHlQcm9wZXJ0aWVzKEN1cnNvciwgJ19jdXJzb3InLCBbXG5cdFx0J2RpcmVjdGlvbicsXG5cdFx0J2tleScsXG5cdFx0J3ByaW1hcnlLZXknLFxuXHRcdCd2YWx1ZSdcblx0XSk7XG5cblx0cHJveHlSZXF1ZXN0TWV0aG9kcyhDdXJzb3IsICdfY3Vyc29yJywgSURCQ3Vyc29yLCBbXG5cdFx0J3VwZGF0ZScsXG5cdFx0J2RlbGV0ZSdcblx0XSk7XG5cblx0Ly8gcHJveHkgJ25leHQnIG1ldGhvZHNcblx0WydhZHZhbmNlJywgJ2NvbnRpbnVlJywgJ2NvbnRpbnVlUHJpbWFyeUtleSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuXHRcdGlmICghKG1ldGhvZE5hbWUgaW4gSURCQ3Vyc29yLnByb3RvdHlwZSkpIHJldHVybjtcblx0XHRDdXJzb3IucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgY3Vyc29yID0gdGhpcztcblx0XHRcdHZhciBhcmdzID0gYXJndW1lbnRzO1xuXHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGN1cnNvci5fY3Vyc29yW21ldGhvZE5hbWVdLmFwcGx5KGN1cnNvci5fY3Vyc29yLCBhcmdzKTtcblx0XHRcdFx0cmV0dXJuIHByb21pc2lmeVJlcXVlc3QoY3Vyc29yLl9yZXF1ZXN0KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdFx0aWYgKCF2YWx1ZSkgcmV0dXJuO1xuXHRcdFx0XHRcdHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBjdXJzb3IuX3JlcXVlc3QpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH07XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIE9iamVjdFN0b3JlKHN0b3JlKSB7XG5cdFx0dGhpcy5fc3RvcmUgPSBzdG9yZTtcblx0fVxuXG5cdE9iamVjdFN0b3JlLnByb3RvdHlwZS5jcmVhdGVJbmRleCA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuY3JlYXRlSW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdE9iamVjdFN0b3JlLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuaW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdHByb3h5UHJvcGVydGllcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIFtcblx0XHQnbmFtZScsXG5cdFx0J2tleVBhdGgnLFxuXHRcdCdpbmRleE5hbWVzJyxcblx0XHQnYXV0b0luY3JlbWVudCdcblx0XSk7XG5cblx0cHJveHlSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG5cdFx0J3B1dCcsXG5cdFx0J2FkZCcsXG5cdFx0J2RlbGV0ZScsXG5cdFx0J2NsZWFyJyxcblx0XHQnZ2V0Jyxcblx0XHQnZ2V0QWxsJyxcblx0XHQnZ2V0S2V5Jyxcblx0XHQnZ2V0QWxsS2V5cycsXG5cdFx0J2NvdW50J1xuXHRdKTtcblxuXHRwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcblx0XHQnb3BlbkN1cnNvcicsXG5cdFx0J29wZW5LZXlDdXJzb3InXG5cdF0pO1xuXG5cdHByb3h5TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG5cdFx0J2RlbGV0ZUluZGV4J1xuXHRdKTtcblxuXHRmdW5jdGlvbiBUcmFuc2FjdGlvbihpZGJUcmFuc2FjdGlvbikge1xuXHRcdHRoaXMuX3R4ID0gaWRiVHJhbnNhY3Rpb247XG5cdFx0dGhpcy5jb21wbGV0ZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0aWRiVHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9O1xuXHRcdFx0aWRiVHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuXHRcdFx0fTtcblx0XHRcdGlkYlRyYW5zYWN0aW9uLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHRUcmFuc2FjdGlvbi5wcm90b3R5cGUub2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX3R4Lm9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX3R4LCBhcmd1bWVudHMpKTtcblx0fTtcblxuXHRwcm94eVByb3BlcnRpZXMoVHJhbnNhY3Rpb24sICdfdHgnLCBbXG5cdFx0J29iamVjdFN0b3JlTmFtZXMnLFxuXHRcdCdtb2RlJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoVHJhbnNhY3Rpb24sICdfdHgnLCBJREJUcmFuc2FjdGlvbiwgW1xuXHRcdCdhYm9ydCdcblx0XSk7XG5cblx0ZnVuY3Rpb24gVXBncmFkZURCKGRiLCBvbGRWZXJzaW9uLCB0cmFuc2FjdGlvbikge1xuXHRcdHRoaXMuX2RiID0gZGI7XG5cdFx0dGhpcy5vbGRWZXJzaW9uID0gb2xkVmVyc2lvbjtcblx0XHR0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTtcblx0fVxuXG5cdFVwZ3JhZGVEQi5wcm90b3R5cGUuY3JlYXRlT2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX2RiLmNyZWF0ZU9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcblx0fTtcblxuXHRwcm94eVByb3BlcnRpZXMoVXBncmFkZURCLCAnX2RiJywgW1xuXHRcdCduYW1lJyxcblx0XHQndmVyc2lvbicsXG5cdFx0J29iamVjdFN0b3JlTmFtZXMnXG5cdF0pO1xuXG5cdHByb3h5TWV0aG9kcyhVcGdyYWRlREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuXHRcdCdkZWxldGVPYmplY3RTdG9yZScsXG5cdFx0J2Nsb3NlJ1xuXHRdKTtcblxuXHRmdW5jdGlvbiBEQihkYikge1xuXHRcdHRoaXMuX2RiID0gZGI7XG5cdH1cblxuXHREQi5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gbmV3IFRyYW5zYWN0aW9uKHRoaXMuX2RiLnRyYW5zYWN0aW9uLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcblx0fTtcblxuXHRwcm94eVByb3BlcnRpZXMoREIsICdfZGInLCBbXG5cdFx0J25hbWUnLFxuXHRcdCd2ZXJzaW9uJyxcblx0XHQnb2JqZWN0U3RvcmVOYW1lcydcblx0XSk7XG5cblx0cHJveHlNZXRob2RzKERCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcblx0XHQnY2xvc2UnXG5cdF0pO1xuXG5cdC8vIEFkZCBjdXJzb3IgaXRlcmF0b3JzXG5cdC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uY2UgYnJvd3NlcnMgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGggcHJvbWlzZXNcblx0WydvcGVuQ3Vyc29yJywgJ29wZW5LZXlDdXJzb3InXS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmNOYW1lKSB7XG5cdFx0W09iamVjdFN0b3JlLCBJbmRleF0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuXHRcdFx0Ly8gRG9uJ3QgY3JlYXRlIGl0ZXJhdGVLZXlDdXJzb3IgaWYgb3BlbktleUN1cnNvciBkb2Vzbid0IGV4aXN0LlxuXHRcdFx0aWYgKCEoZnVuY05hbWUgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXG5cdFx0XHRDb25zdHJ1Y3Rvci5wcm90b3R5cGVbZnVuY05hbWUucmVwbGFjZSgnb3BlbicsICdpdGVyYXRlJyldID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMpO1xuXHRcdFx0XHR2YXIgY2FsbGJhY2sgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07XG5cdFx0XHRcdHZhciBuYXRpdmVPYmplY3QgPSB0aGlzLl9zdG9yZSB8fCB0aGlzLl9pbmRleDtcblx0XHRcdFx0dmFyIHJlcXVlc3QgPSBuYXRpdmVPYmplY3RbZnVuY05hbWVdLmFwcGx5KG5hdGl2ZU9iamVjdCwgYXJncy5zbGljZSgwLCAtMSkpO1xuXHRcdFx0XHRyZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNhbGxiYWNrKHJlcXVlc3QucmVzdWx0KTtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH0pO1xuXG5cdC8vIHBvbHlmaWxsIGdldEFsbFxuXHRbSW5kZXgsIE9iamVjdFN0b3JlXS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG5cdFx0aWYgKENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwpIHJldHVybjtcblx0XHRDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsID0gZnVuY3Rpb24ocXVlcnksIGNvdW50KSB7XG5cdFx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzO1xuXHRcdFx0dmFyIGl0ZW1zID0gW107XG5cblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG5cdFx0XHRcdGluc3RhbmNlLml0ZXJhdGVDdXJzb3IocXVlcnksIGZ1bmN0aW9uKGN1cnNvcikge1xuXHRcdFx0XHRcdGlmICghY3Vyc29yKSB7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKGl0ZW1zKTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aXRlbXMucHVzaChjdXJzb3IudmFsdWUpO1xuXG5cdFx0XHRcdFx0aWYgKGNvdW50ICE9PSB1bmRlZmluZWQgJiYgaXRlbXMubGVuZ3RoID09IGNvdW50KSB7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKGl0ZW1zKTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y3Vyc29yLmNvbnRpbnVlKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSk7XG5cblx0dmFyIGV4cCA9IHtcblx0XHRvcGVuOiBmdW5jdGlvbihuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlQ2FsbGJhY2spIHtcblx0XHRcdHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnb3BlbicsIFtuYW1lLCB2ZXJzaW9uXSk7XG5cdFx0XHR2YXIgcmVxdWVzdCA9IHAucmVxdWVzdDtcblxuXHRcdFx0aWYgKHJlcXVlc3QpIHtcblx0XHRcdFx0cmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0XHRcdGlmICh1cGdyYWRlQ2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdHVwZ3JhZGVDYWxsYmFjayhuZXcgVXBncmFkZURCKHJlcXVlc3QucmVzdWx0LCBldmVudC5vbGRWZXJzaW9uLCByZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gcC50aGVuKGZ1bmN0aW9uKGRiKSB7XG5cdFx0XHRcdHJldHVybiBuZXcgREIoZGIpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRkZWxldGU6IGZ1bmN0aW9uKG5hbWUpIHtcblx0XHRcdHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdkZWxldGVEYXRhYmFzZScsIFtuYW1lXSk7XG5cdFx0fVxuXHR9O1xuXG5cdGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZXhwO1xuXHRcdG1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcblx0fVxuXHRlbHNlIHtcblx0XHRzZWxmLmlkYiA9IGV4cDtcblx0fVxufSgpKTtcbiIsInZhciBBUElfVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MTMzNy9yZXN0YXVyYW50cyc7XG52YXIgZmV0Y2hTdGF0dXMgPSAwO1xudmFyIHJldmlld3NGZXRjaFN0YXR1cyA9IDA7XG52YXIgREJfVkVSU0lPTiA9IDI7XG5cbi8vIEhlbHBlciBGdW5jdGlvbnMgZm9yIHZhcmlvdXMgSURiIE9wZXJhdGlvbnNcbmNsYXNzIElEYk9wZXJhdGlvbnNIZWxwZXIge1xuXHRzdGF0aWMgY2hlY2tGb3JJRGJTdXBwb3J0KCkge1xuXHRcdGlmICghKCdpbmRleGVkREInIGluIHdpbmRvdykpIHtcblx0XHRcdHJldHVybiAwO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gMTtcblx0XHR9XG5cdH1cblxuXHRzdGF0aWMgb3BlbklEYihuYW1lLCB2ZXJzaW9uLCBvYmplY3RTdG9yZU5hbWUpIHtcblx0XHR2YXIgZGJQcm9taXNlID0gaWRiLm9wZW4obmFtZSwgdmVyc2lvbiwgdXBncmFkZURCID0+IHtcblx0XHRcdHVwZ3JhZGVEQi5jcmVhdGVPYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUsIHsgYXV0b0luY3JlbWVudDogdHJ1ZSB9KTtcblx0XHR9KTtcblx0XHRyZXR1cm4gZGJQcm9taXNlO1xuXHR9XG5cblx0c3RhdGljIGFkZFRvRGIoZGJQcm9taXNlLCBvYmplY3RTdG9yZU5hbWUsIHBlcm1pc2lvbiwganNvbkRhdGEpIHtcblx0XHRkYlByb21pc2UudGhlbihkYiA9PiB7XG5cdFx0XHR2YXIgdHJhbnNhY3QgPSBkYi50cmFuc2FjdGlvbihvYmplY3RTdG9yZU5hbWUsIHBlcm1pc2lvbik7XG5cdFx0XHQvL0FkZCBhbGwgdGhlIGpzb24gY29udGVudCBoZXJlXG5cdFx0XHR0cmFuc2FjdC5vYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUpLnB1dChqc29uRGF0YSk7XG5cdFx0XHRyZXR1cm4gdHJhbnNhY3QuY29tcGxldGU7XG5cdFx0fSkudGhlbihyZXNwb25zZSA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZygnRGF0YSBzYXZlZCB0byBJREInKTtcblx0XHRcdHJldHVybiByZXNwb25zZTtcblx0XHR9KS5jYXRjaChlcnIgPT4ge1xuXHRcdFx0cmV0dXJuIGVycjtcblx0XHR9KTtcblx0fVxuXG5cdHN0YXRpYyBnZXRBbGxEYXRhKGRiUHJvbWlzZSwgdHJhbnNhY3Rpb25OYW1lLCBvYmplY3RTdG9yZU5hbWUpIHtcblx0XHR2YXIgcmVzcG9uc2VBcnJheVByb21pc2UgPSBkYlByb21pc2UudGhlbihkYiA9PiBkYlxuXHRcdFx0LnRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uTmFtZSlcblx0XHRcdC5vYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUpXG5cdFx0XHQuZ2V0QWxsKClcblx0XHQpO1xuXHRcdHJlc3BvbnNlQXJyYXlQcm9taXNlLnRoZW4oYXJyeSA9PiB7XG5cdFx0XHRJRGJPcGVyYXRpb25zSGVscGVyLnNldFJlc3RhdXJhbnRzRGF0YShhcnJ5KTtcblx0XHR9KTtcblx0fVxuXG5cdHN0YXRpYyBnZXREYXRhRnJvbVNlcnZlcihkYlByb21pc2UsIG9iamVjdFN0b3JlTmFtZSwgcGVybWlzaW9uLCBjYWxsYmFjaykge1xuXHRcdGZldGNoKEFQSV9VUkwpXG5cdFx0XHQudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG5cdFx0XHQudGhlbihyZXNwb25zZUpzb24gPT4ge1xuXHRcdFx0XHRyZXNwb25zZUpzb24uZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcblx0XHRcdFx0XHRyZXN0YXVyYW50ID0gSURiT3BlcmF0aW9uc0hlbHBlci5hZGRNaXNzaW5nRGF0YShyZXN0YXVyYW50KTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKGZldGNoU3RhdHVzICE9IDEpIHtcblx0XHRcdFx0XHRmZXRjaFN0YXR1cyA9IDE7XG5cdFx0XHRcdFx0cmVzcG9uc2VKc29uLmZvckVhY2gocmVzdGF1cmFudERhdGEgPT4ge1xuXHRcdFx0XHRcdFx0Ly9BZGQgZXZlcnkgc2luZ2xlIHJlc3RhdXJhbnQgZGF0YSB0byBJRGJcblx0XHRcdFx0XHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuYWRkVG9EYihcblx0XHRcdFx0XHRcdFx0ZGJQcm9taXNlLFxuXHRcdFx0XHRcdFx0XHRvYmplY3RTdG9yZU5hbWUsXG5cdFx0XHRcdFx0XHRcdHBlcm1pc2lvbixcblx0XHRcdFx0XHRcdFx0cmVzdGF1cmFudERhdGFcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gY29uc29sZS5sb2cocmVzcG9uc2VKc29uKTtcblx0XHRcdFx0Y2FsbGJhY2sgKG51bGwsIHJlc3BvbnNlSnNvbik7XG5cdFx0XHR9KS5jYXRjaChlcnJvciA9PiB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKGBVbmFibGUgdG8gZmV0Y2ggcmVzdGF1cmFudHMsIEVycm9yOiAke2Vycm9yfWApO1xuXHRcdFx0XHRjYWxsYmFjayAoZXJyb3IsIG51bGwpO1xuXHRcdFx0fSk7XG5cdH1cblxuXHRzdGF0aWMgZ2V0UmVzdGF1cmFudHNEYXRhKGNhbGxiYWNrKSB7XG5cdFx0dmFyIGlkYk5hbWUgPSAncmVzdGF1cmFudHMtZGF0YSc7XG5cdFx0dmFyIGRiVmVyc2lvbiA9IERCX1ZFUlNJT047XG5cdFx0dmFyIG9iamVjdFN0b3JlTmFtZVN0cmluZyA9ICdyZXN0YXVyYW50cyc7XG5cdFx0dmFyIHRyYW5zYWN0aW9uTmFtZVN0cmluZyA9ICdyZXN0YXVyYW50cyc7XG5cdFx0dmFyIGRiUGVybWlzc2lvbiA9ICdyZWFkd3JpdGUnO1xuXG5cdFx0dmFyIGRiUHJvbWlzZSA9IElEYk9wZXJhdGlvbnNIZWxwZXIub3BlbklEYihcblx0XHRcdGlkYk5hbWUsXG5cdFx0XHRkYlZlcnNpb24sXG5cdFx0XHRvYmplY3RTdG9yZU5hbWVTdHJpbmdcblx0XHQpO1xuXG5cdFx0ZGJQcm9taXNlLnRoZW4oZGIgPT5cblx0XHRcdGRiLnRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uTmFtZVN0cmluZylcblx0XHRcdFx0Lm9iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZVN0cmluZylcblx0XHRcdFx0LmdldEFsbCgpXG5cdFx0KS50aGVuKHJlc3BvbnNlT2JlamN0cyA9PiB7XG5cdFx0XHRpZiAocmVzcG9uc2VPYmVqY3RzLmxlbmd0aCA8PSAwKSB7XG5cdFx0XHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuZ2V0RGF0YUZyb21TZXJ2ZXIoXG5cdFx0XHRcdFx0ZGJQcm9taXNlLFxuXHRcdFx0XHRcdG9iamVjdFN0b3JlTmFtZVN0cmluZyxcblx0XHRcdFx0XHRkYlBlcm1pc3Npb24sXG5cdFx0XHRcdFx0Y2FsbGJhY2tcblx0XHRcdFx0KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlT2JlamN0cyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKiBGQUlMRUQ6OjogRnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBSZXN0YXVyYW50IGRhdGEqL1xuXHRzdGF0aWMgdXBkYXRlUmVzdGF1cmFudERhdGEocmVzdGF1cmFudCkge1xuXHRcdHZhciBpZGJOYW1lID0gJ3Jlc3RhdXJhbnRzLWRhdGEnO1xuXHRcdHZhciBkYlZlcnNpb24gPSBEQl9WRVJTSU9OO1xuXHRcdHZhciBvYmplY3RTdG9yZU5hbWUgPSAncmVzdGF1cmFudHMnO1xuXHRcdHZhciB0cmFuc2FjdGlvbk5hbWUgPSAncmVzdGF1cmFudHMnO1xuXHRcdHZhciBkYlBlcm1pc3Npb24gPSAncmVhZHdyaXRlJztcblxuXHRcdHZhciBkYlByb21pc2UgPSBJRGJPcGVyYXRpb25zSGVscGVyLm9wZW5JRGIoXG5cdFx0XHRpZGJOYW1lLFxuXHRcdFx0ZGJWZXJzaW9uLFxuXHRcdFx0b2JqZWN0U3RvcmVOYW1lXG5cdFx0KTtcblxuXHRcdC8qIFB1dCBKU09OIGRhdGEgdG8gaW5kZXhEQiovXG5cdFx0ZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xuXHRcdFx0IHJldHVybiBkYi50cmFuc2FjdGlvbihvYmplY3RTdG9yZU5hbWUsIGRiUGVybWlzc2lvbilcblx0XHRcdC5vYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUpXG5cdFx0XHQucHV0KHJlc3RhdXJhbnQpXG5cdFx0fVxuXHRcdCkudGhlbihyZXMgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coJ3Rlc3Qgc3VjY2VzcycpO1xuXHRcdFx0Y29uc29sZS5sb2cocmVzKTtcblx0XHR9KS5jYXRjaChlcnIgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coJ3Rlc3QgZmFpbGVkJyk7XG5cdFx0XHRjb25zb2xlLmxvZyhlcnIpO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8gSGFuZGxlIGZvciBsYXN0IGVudHJ5IG9uIFJlc3RhdXJhbnRzIExpc3Rcblx0c3RhdGljIGFkZE1pc3NpbmdEYXRhKHJlc3RKc29uKSB7XG5cdFx0aWYgKCFpc05hTihyZXN0SnNvbi5waG90b2dyYXBoKSkge1xuXHRcdFx0cmVzdEpzb24ucGhvdG9ncmFwaCA9IHJlc3RKc29uLnBob3RvZ3JhcGggKyAnLmpwZyc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlc3RKc29uWydwaG90b2dyYXBoJ10gPSByZXN0SnNvbi5pZCArICcuanBnJztcblx0XHR9XG5cdFx0cmV0dXJuIHJlc3RKc29uO1xuXHR9XG5cblx0LyogRmV0Y2ggQWxsIHJldmlld3MgZnJvbSBzZXJ2ZXIgYW5kIHNhdmUgdG8gSW5kZXhEQiBPYmplY3RTdG9yZSovXG5cdHN0YXRpYyBnZXRSZXZpZXdzRnJvbVNlcnZlcihkYlByb21pc2UsIG9iamVjdFN0b3JlTmFtZSwgcGVybWlzaW9uLCBjYWxsYmFjaykge1xuXHRcdGZldGNoKGBodHRwOi8vbG9jYWxob3N0OjEzMzcvcmV2aWV3cy9gKVxuXHRcdFx0LnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuXHRcdFx0LnRoZW4ocmVzcG9uc2VKc29uID0+IHtcblx0XHRcdFx0Ly8gU29ydCBieSByZXN0YXVyYW50IElEXG5cdFx0XHRcdC8vIHJlc3BvbnNlSnNvbi5zb3J0KChhLGIpID0+IGEucmVzdGF1cmFudF9pZCAtIGIucmVzdGF1cmFudF9pZCk7XG5cblx0XHRcdFx0Ly8gQWRkIFJldmlld3MgaW4gSW5kZXhEQiBpZiBub3QgYWRkZWQgYmVmb3JlXG5cdFx0XHRcdGlmIChyZXZpZXdzRmV0Y2hTdGF0dXMgIT0gMSkge1xuXHRcdFx0XHRcdHJldmlld3NGZXRjaFN0YXR1cyA9IDE7XG5cdFx0XHRcdFx0cmVzcG9uc2VKc29uLmZvckVhY2gocmVzdGF1cmFudERhdGEgPT4ge1xuXHRcdFx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5hZGRUb0RiKFxuXHRcdFx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0XHRcdG9iamVjdFN0b3JlTmFtZSxcblx0XHRcdFx0XHRcdFx0cGVybWlzaW9uLFxuXHRcdFx0XHRcdFx0XHRyZXN0YXVyYW50RGF0YVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYWxsYmFjayAobnVsbCwgcmVzcG9uc2VKc29uKTtcblx0XHRcdH0pLmNhdGNoKGVycm9yID0+IHtcblx0XHRcdFx0Y2FsbGJhY2sgKGVycm9yLCBudWxsKTtcblx0XHRcdH0pO1xuXHR9XG5cblx0c3RhdGljIGdldFJldmlld3NEYXRhKGNhbGxiYWNrKSB7XG5cdFx0dmFyIGlkYk5hbWUgPSAncmV2aWV3cy1kYXRhJztcblx0XHR2YXIgZGJWZXJzaW9uID0gREJfVkVSU0lPTjtcblx0XHR2YXIgb2JqZWN0U3RvcmVOYW1lU3RyaW5nID0gJ3Jldmlld3MnO1xuXHRcdHZhciB0cmFuc2FjdGlvbk5hbWVTdHJpbmcgPSAncmV2aWV3cyc7XG5cdFx0dmFyIGRiUGVybWlzc2lvbiA9ICdyZWFkd3JpdGUnO1xuXG5cdFx0dmFyIGRiUHJvbWlzZSA9IElEYk9wZXJhdGlvbnNIZWxwZXIub3BlbklEYihcblx0XHRcdGlkYk5hbWUsXG5cdFx0XHRkYlZlcnNpb24sXG5cdFx0XHRvYmplY3RTdG9yZU5hbWVTdHJpbmdcblx0XHQpO1xuXG5cdFx0ZGJQcm9taXNlLnRoZW4oZGIgPT5cblx0XHRcdGRiLnRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uTmFtZVN0cmluZywgZGJQZXJtaXNzaW9uKVxuXHRcdFx0XHQub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lU3RyaW5nKVxuXHRcdFx0XHQuZ2V0QWxsKClcblx0XHQpLnRoZW4ocmVzcG9uc2VPYmVqY3RzID0+IHtcblx0XHRcdGlmIChyZXNwb25zZU9iZWpjdHMubGVuZ3RoIDw9IDApIHtcblx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXZpZXdzRnJvbVNlcnZlcihcblx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0b2JqZWN0U3RvcmVOYW1lU3RyaW5nLFxuXHRcdFx0XHRcdGRiUGVybWlzc2lvbixcblx0XHRcdFx0XHRjYWxsYmFja1xuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzcG9uc2VPYmVqY3RzKTtcblx0XHRcdH1cblx0XHR9KS5jYXRjaChlcnIgPT4ge1xuXHRcdFx0Y2FsbGJhY2soZXJyLCBudWxsKTtcblx0XHR9KTtcblx0fVxuXG5cdC8vIEFkZCByZXZpZXcgZGF0YSBpbiBpbmRleERCXG5cdHN0YXRpYyBhZGRSZXZpZXdUb0lkYihyZXZpZXdEYXRhKSB7XG5cdFx0dmFyIGlkYk5hbWUgPSAncmV2aWV3cy1kYXRhJztcblx0XHR2YXIgZGJWZXJzaW9uID0gREJfVkVSU0lPTjtcblx0XHR2YXIgb2JqZWN0U3RvcmVOYW1lID0gJ3Jldmlld3MnO1xuXHRcdHZhciB0cmFuc2FjdGlvbk5hbWUgPSAncmV2aWV3cyc7XG5cdFx0dmFyIGRiUGVybWlzc2lvbiA9ICdyZWFkd3JpdGUnO1xuXG5cdFx0dmFyIGRiUHJvbWlzZSA9IElEYk9wZXJhdGlvbnNIZWxwZXIub3BlbklEYihcblx0XHRcdGlkYk5hbWUsXG5cdFx0XHRkYlZlcnNpb24sXG5cdFx0XHRvYmplY3RTdG9yZU5hbWVcblx0XHQpO1xuXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5hZGRUb0RiKFxuXHRcdFx0ZGJQcm9taXNlLFxuXHRcdFx0b2JqZWN0U3RvcmVOYW1lLFxuXHRcdFx0ZGJQZXJtaXNzaW9uLFxuXHRcdFx0cmV2aWV3RGF0YVxuXHRcdCk7XG5cdH1cblxufVxuIiwiLy8gQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXG5jbGFzcyBEQkhlbHBlciB7XG5cdHN0YXRpYyBnZXQgTkVXX1VSTCgpIHtcblx0XHRyZXR1cm4gJ2h0dHA6Ly9sb2NhbGhvc3Q6MTMzNy9yZXN0YXVyYW50cyc7XG5cdH1cblx0LyoqXG4gICAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cbiAgICAgKi9cblx0c3RhdGljIGZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIGNhbGxiYWNrKSB7XG5cdFx0Ly8gZmV0Y2ggYWxsIHJlc3RhdXJhbnRzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuZ2V0UmVzdGF1cmFudHNEYXRhKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zdCByZXN0YXVyYW50ID0gcmVzdGF1cmFudHMuZmluZChyID0+IHIuaWQgPT0gaWQpO1xuXHRcdFx0XHRpZiAocmVzdGF1cmFudCkge1xuXHRcdFx0XHRcdC8vIEdvdCB0aGUgcmVzdGF1cmFudFxuXHRcdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXG5cdFx0XHRcdFx0Y2FsbGJhY2soJ1Jlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QnLCBudWxsKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG4gICAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIHR5cGUgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG4gICAgICovXG5cdHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSwgY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXG5cdFx0XHRcdGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAgICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICAgKi9cblx0c3RhdGljIGZldGNoUmVzdGF1cmFudEJ5TmVpZ2hib3Job29kKG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2Rcblx0XHRcdFx0Y29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG4gICAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIGFuZCBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICAgKi9cblx0c3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChcblx0XHRjdWlzaW5lLFxuXHRcdG5laWdoYm9yaG9vZCxcblx0XHRjYWxsYmFja1xuXHQpIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bGV0IHJlc3VsdHMgPSByZXN0YXVyYW50cztcblx0XHRcdFx0aWYgKGN1aXNpbmUgIT0gJ2FsbCcpIHtcblx0XHRcdFx0XHQvLyBmaWx0ZXIgYnkgY3Vpc2luZVxuXHRcdFx0XHRcdHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHtcblx0XHRcdFx0XHQvLyBmaWx0ZXIgYnkgbmVpZ2hib3Job29kXG5cdFx0XHRcdFx0cmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuICAgICAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuICAgICAqL1xuXHRzdGF0aWMgZmV0Y2hOZWlnaGJvcmhvb2RzKGNhbGxiYWNrKSB7XG5cdFx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xuXHRcdFx0XHRjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzdGF1cmFudHMubWFwKFxuXHRcdFx0XHRcdCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5uZWlnaGJvcmhvb2Rcblx0XHRcdFx0KTtcblx0XHRcdFx0Ly8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBuZWlnaGJvcmhvb2RzXG5cdFx0XHRcdGNvbnN0IHVuaXF1ZU5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzLmZpbHRlcihcblx0XHRcdFx0XHQodiwgaSkgPT4gbmVpZ2hib3Job29kcy5pbmRleE9mKHYpID09IGlcblx0XHRcdFx0KTtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgdW5pcXVlTmVpZ2hib3Job29kcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAgICAgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG4gICAgICovXG5cdHN0YXRpYyBmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XG5cdFx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEdldCBhbGwgY3Vpc2luZXMgZnJvbSBhbGwgcmVzdGF1cmFudHNcblx0XHRcdFx0Y29uc3QgY3Vpc2luZXMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLmN1aXNpbmVfdHlwZSk7XG5cdFx0XHRcdC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcblx0XHRcdFx0Y29uc3QgdW5pcXVlQ3Vpc2luZXMgPSBjdWlzaW5lcy5maWx0ZXIoXG5cdFx0XHRcdFx0KHYsIGkpID0+IGN1aXNpbmVzLmluZGV4T2YodikgPT0gaVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCB1bmlxdWVDdWlzaW5lcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAgICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxuICAgICAqL1xuXHRzdGF0aWMgdXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XG5cdFx0cmV0dXJuIGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YDtcblx0fVxuXG5cdC8qKlxuICAgICAqIFJlc3RhdXJhbnQgaW1hZ2UgVVJMLlxuICAgICAqL1xuXHRzdGF0aWMgaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcblx0XHRyZXR1cm4gYC9pbWcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGh9YDtcblx0fVxuXG5cdC8qKlxuICAgICAqIE1hcCBtYXJrZXIgZm9yIGEgcmVzdGF1cmFudC5cbiAgICAgKi9cblx0c3RhdGljIG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XG5cdFx0Y29uc3QgbWFya2VyID0gbmV3IEwubWFya2VyKFxuXHRcdFx0W3Jlc3RhdXJhbnQubGF0bG5nLmxhdCwgcmVzdGF1cmFudC5sYXRsbmcubG5nXSxcblx0XHRcdHtcblx0XHRcdFx0dGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcblx0XHRcdFx0YWx0OiByZXN0YXVyYW50Lm5hbWUsXG5cdFx0XHRcdHVybDogREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KVxuXHRcdFx0fVxuXHRcdCk7XG5cdFx0bWFya2VyLmFkZFRvKG5ld01hcCk7XG5cdFx0cmV0dXJuIG1hcmtlcjtcblx0fVxuXG5cdC8qIEdldCByZXZpZXdzIGZvciBhIHJlc3RhdXJhbnQqL1xuXHRzdGF0aWMgZmV0Y2hSZXZpZXdzRm9yUmVzdGF1cmFudChyZXN0YXVyYW50X2lkLCBjYWxsYmFjaykge1xuXHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuZ2V0UmV2aWV3c0RhdGEoKGVycm9yLCBhbGxSZXZpZXdzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bGV0IHJldmlld3MgPSBhbGxSZXZpZXdzLmZpbHRlcihyID0+IHIucmVzdGF1cmFudF9pZCA9PSByZXN0YXVyYW50X2lkKTtcblx0XHRcdFx0aWYgKHJldmlld3MpIHtcblx0XHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXZpZXdzKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjYWxsYmFjaygnUmV2aWV3IGRvZXMgbm90IGV4aXN0JywgbnVsbCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qIEFkZCBuZXcgcmV2aWV3IGZvciBhIHJlc3RhdXJhbnQqL1xuXHRzdGF0aWMgYWRkUmV2aWV3Rm9yUmVzdGF1cmFudChyZXZpZXdEYXRhLCBjYWxsYmFjaykge1xuXHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuYWRkUmV2aWV3VG9JZGIocmV2aWV3RGF0YSk7XG5cdFx0Y2FsbGJhY2soJ1JldmlldyBhZGRlZCB0byBJREInKTtcblx0fVxuXG5cbn1cbiJdLCJmaWxlIjoiYXBwLW1pbi5qcyJ9
