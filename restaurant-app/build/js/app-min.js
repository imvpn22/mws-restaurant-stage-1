navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js").then(t=>{console.log("*** Service Worker registered ***")}).catch(function(t){console.log(t)}),function(){function t(t){return new Promise(function(e,r){t.onsuccess=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function e(e,r,n){var o,a=new Promise(function(a,s){t(o=e[r].apply(e,n)).then(a,s)});return a.request=o,a}function r(t,e,r){r.forEach(function(r){Object.defineProperty(t.prototype,r,{get:function(){return this[e][r]},set:function(t){this[e][r]=t}})})}function n(t,r,n,o){o.forEach(function(o){o in n.prototype&&(t.prototype[o]=function(){return e(this[r],o,arguments)})})}function o(t,e,r,n){n.forEach(function(n){n in r.prototype&&(t.prototype[n]=function(){return this[e][n].apply(this[e],arguments)})})}function a(t,r,n,o){o.forEach(function(o){o in n.prototype&&(t.prototype[o]=function(){return t=this[r],(n=e(t,o,arguments)).then(function(t){if(t)return new i(t,n.request)});var t,n})})}function s(t){this._index=t}function i(t,e){this._cursor=t,this._request=e}function u(t){this._store=t}function c(t){this._tx=t,this.complete=new Promise(function(e,r){t.oncomplete=function(){e()},t.onerror=function(){r(t.error)},t.onabort=function(){r(t.error)}})}function l(t,e,r){this._db=t,this.oldVersion=e,this.transaction=new c(r)}function p(t){this._db=t}r(s,"_index",["name","keyPath","multiEntry","unique"]),n(s,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(s,"_index",IDBIndex,["openCursor","openKeyCursor"]),r(i,"_cursor",["direction","key","primaryKey","value"]),n(i,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(i.prototype[e]=function(){var r=this,n=arguments;return Promise.resolve().then(function(){return r._cursor[e].apply(r._cursor,n),t(r._request).then(function(t){if(t)return new i(t,r._request)})})})}),u.prototype.createIndex=function(){return new s(this._store.createIndex.apply(this._store,arguments))},u.prototype.index=function(){return new s(this._store.index.apply(this._store,arguments))},r(u,"_store",["name","keyPath","indexNames","autoIncrement"]),n(u,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),a(u,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(u,"_store",IDBObjectStore,["deleteIndex"]),c.prototype.objectStore=function(){return new u(this._tx.objectStore.apply(this._tx,arguments))},r(c,"_tx",["objectStoreNames","mode"]),o(c,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new u(this._db.createObjectStore.apply(this._db,arguments))},r(l,"_db",["name","version","objectStoreNames"]),o(l,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new c(this._db.transaction.apply(this._db,arguments))},r(p,"_db",["name","version","objectStoreNames"]),o(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[u,s].forEach(function(e){t in e.prototype&&(e.prototype[t.replace("open","iterate")]=function(){var e,r=(e=arguments,Array.prototype.slice.call(e)),n=r[r.length-1],o=this._store||this._index,a=o[t].apply(o,r.slice(0,-1));a.onsuccess=function(){n(a.result)}})})}),[s,u].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var r=this,n=[];return new Promise(function(o){r.iterateCursor(t,function(t){t?(n.push(t.value),void 0===e||n.length!=e?t.continue():o(n)):o(n)})})})});var h={open:function(t,r,n){var o=e(indexedDB,"open",[t,r]),a=o.request;return a&&(a.onupgradeneeded=function(t){n&&n(new l(a.result,t.oldVersion,a.transaction))}),o.then(function(t){return new p(t)})},delete:function(t){return e(indexedDB,"deleteDatabase",[t])}};"undefined"!=typeof module?(module.exports=h,module.exports.default=module.exports):self.idb=h}();var API_URL="http://localhost:1337/restaurants",fetchStatus=0,reviewsFetchStatus=0,DB_VERSION=1;class IDbOperationsHelper{static checkForIDbSupport(){return"indexedDB"in window?1:0}static openIDb(t,e,r){return idb.open(t,e,t=>{t.createObjectStore(r,{autoIncrement:!0})})}static addToDb(t,e,r,n){t.then(t=>{var o=t.transaction(e,r);return o.objectStore(e).put(n),o.complete}).then(t=>{console.log("Restaurant saved to IDB")})}static getAllData(t,e,r){t.then(t=>t.transaction(e).objectStore(r).getAll()).then(t=>{IDbOperationsHelper.setRestaurantsData(t)})}static getDataFromServer(t,e,r,n){fetch(API_URL).then(t=>t.json()).then(o=>{o.forEach(t=>{t=IDbOperationsHelper.addMissingData(t)}),1!=fetchStatus&&(fetchStatus=1,o.forEach(n=>{IDbOperationsHelper.addToDb(t,e,r,n)})),n(null,o)}).catch(t=>{n(t,null)})}static getRestaurantsData(t){var e=DB_VERSION,r=IDbOperationsHelper.openIDb("restaurants-data",e,"restaurants");r.then(t=>t.transaction("restaurants").objectStore("restaurants").getAll()).then(e=>{e.length<=0?IDbOperationsHelper.getDataFromServer(r,"restaurants","readwrite",t):t(null,e)})}static updateRestaurantData(t){var e=DB_VERSION;IDbOperationsHelper.openIDb("restaurants-data",e,"restaurants").then(e=>e.transaction("restaurants","readwrite").objectStore("restaurants").put(t)).then(t=>{console.log("test success"),console.log(t)}).catch(t=>{console.log("test failed"),console.log(t)})}static addMissingData(t){return isNaN(t.photograph)?t.photograph=t.id+".jpg":t.photograph=t.photograph+".jpg",t}static getReviewsFromServer(t,e,r,n){fetch("http://localhost:1337/reviews/").then(t=>t.json()).then(o=>{1!=reviewsFetchStatus&&(reviewsFetchStatus=1,o.forEach(n=>{IDbOperationsHelper.addToDb(t,e,r,n)})),n(null,o)}).catch(t=>{n(t,null)})}static getReviewsData(t){var e=DB_VERSION,r=IDbOperationsHelper.openIDb("restaurants-data",e,"reviews");r.then(t=>t.transaction("reviews","readwrite").objectStore("reviews").getAll()).then(e=>{e.length<=0?IDbOperationsHelper.getReviewsFromServer(r,"reviews","readwrite",t):t(null,e)}).catch(e=>{t(e,null)})}}class DBHelper{static get NEW_URL(){return"http://localhost:1337/restaurants"}static fetchRestaurantById(t,e){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)e(r,null);else{const r=n.find(e=>e.id==t);r?e(null,r):e("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(t,e){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)e(r,null);else{const r=n.filter(e=>e.cuisine_type==t);e(null,r)}})}static fetchRestaurantByNeighborhood(t,e){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)e(r,null);else{const r=n.filter(e=>e.neighborhood==t);e(null,r)}})}static fetchRestaurantByCuisineAndNeighborhood(t,e,r){IDbOperationsHelper.getRestaurantsData((n,o)=>{if(n)r(n,null);else{let n=o;"all"!=t&&(n=n.filter(e=>e.cuisine_type==t)),"all"!=e&&(n=n.filter(t=>t.neighborhood==e)),r(null,n)}})}static fetchNeighborhoods(t){IDbOperationsHelper.getRestaurantsData((e,r)=>{if(e)t(e,null);else{const e=r.map((t,e)=>r[e].neighborhood),n=e.filter((t,r)=>e.indexOf(t)==r);t(null,n)}})}static fetchCuisines(t){IDbOperationsHelper.getRestaurantsData((e,r)=>{if(e)t(e,null);else{const e=r.map((t,e)=>r[e].cuisine_type),n=e.filter((t,r)=>e.indexOf(t)==r);t(null,n)}})}static urlForRestaurant(t){return`./restaurant.html?id=${t.id}`}static imageUrlForRestaurant(t){return`/img/${t.photograph}`}static mapMarkerForRestaurant(t,e){const r=new L.marker([t.latlng.lat,t.latlng.lng],{title:t.name,alt:t.name,url:DBHelper.urlForRestaurant(t)});return r.addTo(newMap),r}static fetchReviewsForRestaurant(t,e){IDbOperationsHelper.getReviewsData((r,n)=>{if(r)e(r,null);else{let r=n.filter(e=>e.restaurant_id==t);r?e(null,r):e("Review does not exist",null)}})}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4Q29udHJvbGxlci5qcyIsImlkYi5qcyIsIklEYk9wZXJhdGlvbnNIZWxwZXIuanMiLCJkYmhlbHBlci5qcyJdLCJuYW1lcyI6WyJuYXZpZ2F0b3IiLCJzZXJ2aWNlV29ya2VyIiwicmVnaXN0ZXIiLCJ0aGVuIiwicmVnIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyIiwicHJvbWlzaWZ5UmVxdWVzdCIsInJlcXVlc3QiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uc3VjY2VzcyIsInJlc3VsdCIsIm9uZXJyb3IiLCJlcnJvciIsInByb21pc2lmeVJlcXVlc3RDYWxsIiwib2JqIiwibWV0aG9kIiwiYXJncyIsInAiLCJhcHBseSIsInByb3h5UHJvcGVydGllcyIsIlByb3h5Q2xhc3MiLCJ0YXJnZXRQcm9wIiwicHJvcGVydGllcyIsImZvckVhY2giLCJwcm9wIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b3R5cGUiLCJnZXQiLCJ0aGlzIiwic2V0IiwidmFsIiwicHJveHlSZXF1ZXN0TWV0aG9kcyIsIkNvbnN0cnVjdG9yIiwiYXJndW1lbnRzIiwicHJveHlNZXRob2RzIiwicHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyIsInZhbHVlIiwiQ3Vyc29yIiwiSW5kZXgiLCJpbmRleCIsIl9pbmRleCIsImN1cnNvciIsIl9jdXJzb3IiLCJfcmVxdWVzdCIsIk9iamVjdFN0b3JlIiwic3RvcmUiLCJfc3RvcmUiLCJUcmFuc2FjdGlvbiIsImlkYlRyYW5zYWN0aW9uIiwiX3R4IiwiY29tcGxldGUiLCJvbmNvbXBsZXRlIiwib25hYm9ydCIsIlVwZ3JhZGVEQiIsImRiIiwib2xkVmVyc2lvbiIsInRyYW5zYWN0aW9uIiwiX2RiIiwiREIiLCJJREJJbmRleCIsIklEQkN1cnNvciIsIm1ldGhvZE5hbWUiLCJjcmVhdGVJbmRleCIsIklEQk9iamVjdFN0b3JlIiwib2JqZWN0U3RvcmUiLCJJREJUcmFuc2FjdGlvbiIsImNyZWF0ZU9iamVjdFN0b3JlIiwiSURCRGF0YWJhc2UiLCJmdW5jTmFtZSIsInJlcGxhY2UiLCJhcnIiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsImNhbGxiYWNrIiwibGVuZ3RoIiwibmF0aXZlT2JqZWN0IiwiZ2V0QWxsIiwicXVlcnkiLCJjb3VudCIsImluc3RhbmNlIiwiaXRlbXMiLCJpdGVyYXRlQ3Vyc29yIiwicHVzaCIsInVuZGVmaW5lZCIsImNvbnRpbnVlIiwiZXhwIiwib3BlbiIsIm5hbWUiLCJ2ZXJzaW9uIiwidXBncmFkZUNhbGxiYWNrIiwiaW5kZXhlZERCIiwib251cGdyYWRlbmVlZGVkIiwiZXZlbnQiLCJkZWxldGUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZGVmYXVsdCIsInNlbGYiLCJpZGIiLCJBUElfVVJMIiwiZmV0Y2hTdGF0dXMiLCJyZXZpZXdzRmV0Y2hTdGF0dXMiLCJEQl9WRVJTSU9OIiwiSURiT3BlcmF0aW9uc0hlbHBlciIsIltvYmplY3QgT2JqZWN0XSIsIndpbmRvdyIsIm9iamVjdFN0b3JlTmFtZSIsInVwZ3JhZGVEQiIsImF1dG9JbmNyZW1lbnQiLCJkYlByb21pc2UiLCJwZXJtaXNpb24iLCJqc29uRGF0YSIsInRyYW5zYWN0IiwicHV0IiwicmVzcG9uc2UiLCJ0cmFuc2FjdGlvbk5hbWUiLCJhcnJ5Iiwic2V0UmVzdGF1cmFudHNEYXRhIiwiZmV0Y2giLCJqc29uIiwicmVzcG9uc2VKc29uIiwicmVzdGF1cmFudCIsImFkZE1pc3NpbmdEYXRhIiwicmVzdGF1cmFudERhdGEiLCJhZGRUb0RiIiwiZGJWZXJzaW9uIiwib3BlbklEYiIsInJlc3BvbnNlT2JlamN0cyIsImdldERhdGFGcm9tU2VydmVyIiwicmVzIiwicmVzdEpzb24iLCJpc05hTiIsInBob3RvZ3JhcGgiLCJpZCIsImdldFJldmlld3NGcm9tU2VydmVyIiwiREJIZWxwZXIiLCJORVdfVVJMIiwiZ2V0UmVzdGF1cmFudHNEYXRhIiwicmVzdGF1cmFudHMiLCJmaW5kIiwiciIsImN1aXNpbmUiLCJyZXN1bHRzIiwiZmlsdGVyIiwiY3Vpc2luZV90eXBlIiwibmVpZ2hib3Job29kIiwibmVpZ2hib3Job29kcyIsIm1hcCIsInYiLCJpIiwidW5pcXVlTmVpZ2hib3Job29kcyIsImluZGV4T2YiLCJjdWlzaW5lcyIsInVuaXF1ZUN1aXNpbmVzIiwibWFya2VyIiwiTCIsImxhdGxuZyIsImxhdCIsImxuZyIsInRpdGxlIiwiYWx0IiwidXJsIiwidXJsRm9yUmVzdGF1cmFudCIsImFkZFRvIiwibmV3TWFwIiwicmVzdGF1cmFudF9pZCIsImdldFJldmlld3NEYXRhIiwiYWxsUmV2aWV3cyIsInJldmlld3MiXSwibWFwcGluZ3MiOiJBQUFJQSxVQUFVQyxlQUNiRCxVQUFVQyxjQUFjQyxTQUFTLFVBQVVDLEtBQUtDLElBQy9DQyxRQUFRQyxJQUFJLHVDQUNWQyxNQUFNLFNBQVNDLEdBQ2pCSCxRQUFRQyxJQUFJRSxLQU1iLFdBS0EsU0FBU0MsRUFBaUJDLEdBQ3pCLE9BQU8sSUFBSUMsUUFBUSxTQUFTQyxFQUFTQyxHQUNwQ0gsRUFBUUksVUFBWSxXQUNuQkYsRUFBUUYsRUFBUUssU0FHakJMLEVBQVFNLFFBQVUsV0FDakJILEVBQU9ILEVBQVFPLFVBS2xCLFNBQVNDLEVBQXFCQyxFQUFLQyxFQUFRQyxHQUMxQyxJQUFJWCxFQUNBWSxFQUFJLElBQUlYLFFBQVEsU0FBU0MsRUFBU0MsR0FFckNKLEVBREFDLEVBQVVTLEVBQUlDLEdBQVFHLE1BQU1KLEVBQUtFLElBQ1BsQixLQUFLUyxFQUFTQyxLQUl6QyxPQURBUyxFQUFFWixRQUFVQSxFQUNMWSxFQVdSLFNBQVNFLEVBQWdCQyxFQUFZQyxFQUFZQyxHQUNoREEsRUFBV0MsUUFBUSxTQUFTQyxHQUMzQkMsT0FBT0MsZUFBZU4sRUFBV08sVUFBV0gsRUFBTSxDQUNqREksSUFBSyxXQUNKLE9BQU9DLEtBQUtSLEdBQVlHLElBRXpCTSxJQUFLLFNBQVNDLEdBQ2JGLEtBQUtSLEdBQVlHLEdBQVFPLE9BTTdCLFNBQVNDLEVBQW9CWixFQUFZQyxFQUFZWSxFQUFhWCxHQUNq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VyxHQUFHSixjQUdwQkssRUFBc0JKLEVBQWNILE9BQ3pDLENBQUNLLEVBQUdDLElBQU1ILEVBQWNLLFFBQVFILElBQU1DLEdBRXZDNUUsRUFBUyxLQUFNNkUsTUFRbEI5QyxxQkFBcUIvQixHQUVwQjhCLG9CQUFvQmtDLG1CQUFtQixDQUFDL0gsRUFBT2dJLEtBQzlDLEdBQUloSSxFQUNIK0QsRUFBUy9ELEVBQU8sVUFDVixDQUVOLE1BQU04SSxFQUFXZCxFQUFZUyxJQUFJLENBQUNDLEVBQUdDLElBQU1YLEVBQVlXLEdBQUdMLGNBRXBEUyxFQUFpQkQsRUFBU1QsT0FDL0IsQ0FBQ0ssRUFBR0MsSUFBTUcsRUFBU0QsUUFBUUgsSUFBTUMsR0FFbEM1RSxFQUFTLEtBQU1nRixNQVFsQmpELHdCQUF3QmlCLEdBQ3ZCLDhCQUErQkEsRUFBV1ksS0FNM0M3Qiw2QkFBNkJpQixHQUM1QixjQUFlQSxFQUFXVyxhQU0zQjVCLDhCQUE4QmlCLEVBQVkwQixHQUN6QyxNQUFNTyxFQUFTLElBQUlDLEVBQUVELE9BQ3BCLENBQUNqQyxFQUFXbUMsT0FBT0MsSUFBS3BDLEVBQVdtQyxPQUFPRSxLQUMxQyxDQUNDQyxNQUFPdEMsRUFBV2xDLEtBQ2xCeUUsSUFBS3ZDLEVBQVdsQyxLQUNoQjBFLElBQUsxQixTQUFTMkIsaUJBQWlCekMsS0FJakMsT0FEQWlDLEVBQU9TLE1BQU1DLFFBQ05WLEVBSVJsRCxpQ0FBaUM2RCxFQUFlNUYsR0FDL0M4QixvQkFBb0IrRCxlQUFlLENBQUM1SixFQUFPNkosS0FDMUMsR0FBSTdKLEVBQ0grRCxFQUFTL0QsRUFBTyxVQUNWLENBQ04sSUFBSThKLEVBQVVELEVBQVd4QixPQUFPSCxHQUFLQSxFQUFFeUIsZUFBaUJBLEdBQ3BERyxFQUNIL0YsRUFBUyxLQUFNK0YsR0FFZi9GLEVBQVMsd0JBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiaWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSB7XG5cdG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCcvc3cuanMnKS50aGVuKHJlZyA9PiB7XG5cdFx0Y29uc29sZS5sb2coJyoqKiBTZXJ2aWNlIFdvcmtlciByZWdpc3RlcmVkICoqKicpO1xuXHR9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRjb25zb2xlLmxvZyhlcnIpO1xuXHR9KTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uKCkge1xuXHRmdW5jdGlvbiB0b0FycmF5KGFycikge1xuXHRcdHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0cmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVzb2x2ZShyZXF1ZXN0LnJlc3VsdCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRyZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG5cdFx0dmFyIHJlcXVlc3Q7XG5cdFx0dmFyIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHJlcXVlc3QgPSBvYmpbbWV0aG9kXS5hcHBseShvYmosIGFyZ3MpO1xuXHRcdFx0cHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG5cdFx0fSk7XG5cblx0XHRwLnJlcXVlc3QgPSByZXF1ZXN0O1xuXHRcdHJldHVybiBwO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcblx0XHR2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKTtcblx0XHRyZXR1cm4gcC50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRpZiAoIXZhbHVlKSByZXR1cm47XG5cdFx0XHRyZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgcC5yZXF1ZXN0KTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb3h5UHJvcGVydGllcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBwcm9wZXJ0aWVzKSB7XG5cdFx0cHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eUNsYXNzLnByb3RvdHlwZSwgcHJvcCwge1xuXHRcdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZXQ6IGZ1bmN0aW9uKHZhbCkge1xuXHRcdFx0XHRcdHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0gPSB2YWw7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJveHlSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuXHRcdHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG5cdFx0XHRpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblx0XHRcdFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb3h5TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuXHRcdHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG5cdFx0XHRpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblx0XHRcdFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdLmFwcGx5KHRoaXNbdGFyZ2V0UHJvcF0sIGFyZ3VtZW50cyk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuXHRcdHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG5cdFx0XHRpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblx0XHRcdFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIEluZGV4KGluZGV4KSB7XG5cdFx0dGhpcy5faW5kZXggPSBpbmRleDtcblx0fVxuXG5cdHByb3h5UHJvcGVydGllcyhJbmRleCwgJ19pbmRleCcsIFtcblx0XHQnbmFtZScsXG5cdFx0J2tleVBhdGgnLFxuXHRcdCdtdWx0aUVudHJ5Jyxcblx0XHQndW5pcXVlJ1xuXHRdKTtcblxuXHRwcm94eVJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcblx0XHQnZ2V0Jyxcblx0XHQnZ2V0S2V5Jyxcblx0XHQnZ2V0QWxsJyxcblx0XHQnZ2V0QWxsS2V5cycsXG5cdFx0J2NvdW50J1xuXHRdKTtcblxuXHRwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcblx0XHQnb3BlbkN1cnNvcicsXG5cdFx0J29wZW5LZXlDdXJzb3InXG5cdF0pO1xuXG5cdGZ1bmN0aW9uIEN1cnNvcihjdXJzb3IsIHJlcXVlc3QpIHtcblx0XHR0aGlzLl9jdXJzb3IgPSBjdXJzb3I7XG5cdFx0dGhpcy5fcmVxdWVzdCA9IHJlcXVlc3Q7XG5cdH1cblxuXHRwcm94eVByb3BlcnRpZXMoQ3Vyc29yLCAnX2N1cnNvcicsIFtcblx0XHQnZGlyZWN0aW9uJyxcblx0XHQna2V5Jyxcblx0XHQncHJpbWFyeUtleScsXG5cdFx0J3ZhbHVlJ1xuXHRdKTtcblxuXHRwcm94eVJlcXVlc3RNZXRob2RzKEN1cnNvciwgJ19jdXJzb3InLCBJREJDdXJzb3IsIFtcblx0XHQndXBkYXRlJyxcblx0XHQnZGVsZXRlJ1xuXHRdKTtcblxuXHQvLyBwcm94eSAnbmV4dCcgbWV0aG9kc1xuXHRbJ2FkdmFuY2UnLCAnY29udGludWUnLCAnY29udGludWVQcmltYXJ5S2V5J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2ROYW1lKSB7XG5cdFx0aWYgKCEobWV0aG9kTmFtZSBpbiBJREJDdXJzb3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXHRcdEN1cnNvci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBjdXJzb3IgPSB0aGlzO1xuXHRcdFx0dmFyIGFyZ3MgPSBhcmd1bWVudHM7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpIHtcblx0XHRcdFx0Y3Vyc29yLl9jdXJzb3JbbWV0aG9kTmFtZV0uYXBwbHkoY3Vyc29yLl9jdXJzb3IsIGFyZ3MpO1xuXHRcdFx0XHRyZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdChjdXJzb3IuX3JlcXVlc3QpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0XHRpZiAoIXZhbHVlKSByZXR1cm47XG5cdFx0XHRcdFx0cmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIGN1cnNvci5fcmVxdWVzdCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSk7XG5cblx0ZnVuY3Rpb24gT2JqZWN0U3RvcmUoc3RvcmUpIHtcblx0XHR0aGlzLl9zdG9yZSA9IHN0b3JlO1xuXHR9XG5cblx0T2JqZWN0U3RvcmUucHJvdG90eXBlLmNyZWF0ZUluZGV4ID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5jcmVhdGVJbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG5cdH07XG5cblx0T2JqZWN0U3RvcmUucHJvdG90eXBlLmluZGV4ID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5pbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG5cdH07XG5cblx0cHJveHlQcm9wZXJ0aWVzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgW1xuXHRcdCduYW1lJyxcblx0XHQna2V5UGF0aCcsXG5cdFx0J2luZGV4TmFtZXMnLFxuXHRcdCdhdXRvSW5jcmVtZW50J1xuXHRdKTtcblxuXHRwcm94eVJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcblx0XHQncHV0Jyxcblx0XHQnYWRkJyxcblx0XHQnZGVsZXRlJyxcblx0XHQnY2xlYXInLFxuXHRcdCdnZXQnLFxuXHRcdCdnZXRBbGwnLFxuXHRcdCdnZXRLZXknLFxuXHRcdCdnZXRBbGxLZXlzJyxcblx0XHQnY291bnQnXG5cdF0pO1xuXG5cdHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuXHRcdCdvcGVuQ3Vyc29yJyxcblx0XHQnb3BlbktleUN1cnNvcidcblx0XSk7XG5cblx0cHJveHlNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcblx0XHQnZGVsZXRlSW5kZXgnXG5cdF0pO1xuXG5cdGZ1bmN0aW9uIFRyYW5zYWN0aW9uKGlkYlRyYW5zYWN0aW9uKSB7XG5cdFx0dGhpcy5fdHggPSBpZGJUcmFuc2FjdGlvbjtcblx0XHR0aGlzLmNvbXBsZXRlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRpZGJUcmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdH07XG5cdFx0XHRpZGJUcmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG5cdFx0XHR9O1xuXHRcdFx0aWRiVHJhbnNhY3Rpb24ub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fdHgub2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fdHgsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdHByb3h5UHJvcGVydGllcyhUcmFuc2FjdGlvbiwgJ190eCcsIFtcblx0XHQnb2JqZWN0U3RvcmVOYW1lcycsXG5cdFx0J21vZGUnXG5cdF0pO1xuXG5cdHByb3h5TWV0aG9kcyhUcmFuc2FjdGlvbiwgJ190eCcsIElEQlRyYW5zYWN0aW9uLCBbXG5cdFx0J2Fib3J0J1xuXHRdKTtcblxuXHRmdW5jdGlvbiBVcGdyYWRlREIoZGIsIG9sZFZlcnNpb24sIHRyYW5zYWN0aW9uKSB7XG5cdFx0dGhpcy5fZGIgPSBkYjtcblx0XHR0aGlzLm9sZFZlcnNpb24gPSBvbGRWZXJzaW9uO1xuXHRcdHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xuXHR9XG5cblx0VXBncmFkZURCLnByb3RvdHlwZS5jcmVhdGVPYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fZGIuY3JlYXRlT2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdHByb3h5UHJvcGVydGllcyhVcGdyYWRlREIsICdfZGInLCBbXG5cdFx0J25hbWUnLFxuXHRcdCd2ZXJzaW9uJyxcblx0XHQnb2JqZWN0U3RvcmVOYW1lcydcblx0XSk7XG5cblx0cHJveHlNZXRob2RzKFVwZ3JhZGVEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG5cdFx0J2RlbGV0ZU9iamVjdFN0b3JlJyxcblx0XHQnY2xvc2UnXG5cdF0pO1xuXG5cdGZ1bmN0aW9uIERCKGRiKSB7XG5cdFx0dGhpcy5fZGIgPSBkYjtcblx0fVxuXG5cdERCLnByb3RvdHlwZS50cmFuc2FjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5fZGIudHJhbnNhY3Rpb24uYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdHByb3h5UHJvcGVydGllcyhEQiwgJ19kYicsIFtcblx0XHQnbmFtZScsXG5cdFx0J3ZlcnNpb24nLFxuXHRcdCdvYmplY3RTdG9yZU5hbWVzJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuXHRcdCdjbG9zZSdcblx0XSk7XG5cblx0Ly8gQWRkIGN1cnNvciBpdGVyYXRvcnNcblx0Ly8gVE9ETzogcmVtb3ZlIHRoaXMgb25jZSBicm93c2VycyBkbyB0aGUgcmlnaHQgdGhpbmcgd2l0aCBwcm9taXNlc1xuXHRbJ29wZW5DdXJzb3InLCAnb3BlbktleUN1cnNvciddLmZvckVhY2goZnVuY3Rpb24oZnVuY05hbWUpIHtcblx0XHRbT2JqZWN0U3RvcmUsIEluZGV4XS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG5cdFx0XHQvLyBEb24ndCBjcmVhdGUgaXRlcmF0ZUtleUN1cnNvciBpZiBvcGVuS2V5Q3Vyc29yIGRvZXNuJ3QgZXhpc3QuXG5cdFx0XHRpZiAoIShmdW5jTmFtZSBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG5cblx0XHRcdENvbnN0cnVjdG9yLnByb3RvdHlwZVtmdW5jTmFtZS5yZXBsYWNlKCdvcGVuJywgJ2l0ZXJhdGUnKV0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG5cdFx0XHRcdHZhciBjYWxsYmFjayA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcblx0XHRcdFx0dmFyIG5hdGl2ZU9iamVjdCA9IHRoaXMuX3N0b3JlIHx8IHRoaXMuX2luZGV4O1xuXHRcdFx0XHR2YXIgcmVxdWVzdCA9IG5hdGl2ZU9iamVjdFtmdW5jTmFtZV0uYXBwbHkobmF0aXZlT2JqZWN0LCBhcmdzLnNsaWNlKDAsIC0xKSk7XG5cdFx0XHRcdHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2socmVxdWVzdC5yZXN1bHQpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fSk7XG5cblx0Ly8gcG9seWZpbGwgZ2V0QWxsXG5cdFtJbmRleCwgT2JqZWN0U3RvcmVdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcblx0XHRpZiAoQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCkgcmV0dXJuO1xuXHRcdENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbihxdWVyeSwgY291bnQpIHtcblx0XHRcdHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cdFx0XHR2YXIgaXRlbXMgPSBbXTtcblxuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcblx0XHRcdFx0aW5zdGFuY2UuaXRlcmF0ZUN1cnNvcihxdWVyeSwgZnVuY3Rpb24oY3Vyc29yKSB7XG5cdFx0XHRcdFx0aWYgKCFjdXJzb3IpIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoaXRlbXMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XG5cblx0XHRcdFx0XHRpZiAoY291bnQgIT09IHVuZGVmaW5lZCAmJiBpdGVtcy5sZW5ndGggPT0gY291bnQpIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoaXRlbXMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRjdXJzb3IuY29udGludWUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KTtcblxuXHR2YXIgZXhwID0ge1xuXHRcdG9wZW46IGZ1bmN0aW9uKG5hbWUsIHZlcnNpb24sIHVwZ3JhZGVDYWxsYmFjaykge1xuXHRcdFx0dmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdvcGVuJywgW25hbWUsIHZlcnNpb25dKTtcblx0XHRcdHZhciByZXF1ZXN0ID0gcC5yZXF1ZXN0O1xuXG5cdFx0XHRpZiAocmVxdWVzdCkge1xuXHRcdFx0XHRyZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdFx0aWYgKHVwZ3JhZGVDYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0dXBncmFkZUNhbGxiYWNrKG5ldyBVcGdyYWRlREIocmVxdWVzdC5yZXN1bHQsIGV2ZW50Lm9sZFZlcnNpb24sIHJlcXVlc3QudHJhbnNhY3Rpb24pKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBwLnRoZW4oZnVuY3Rpb24oZGIpIHtcblx0XHRcdFx0cmV0dXJuIG5ldyBEQihkYik7XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdGRlbGV0ZTogZnVuY3Rpb24obmFtZSkge1xuXHRcdFx0cmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ2RlbGV0ZURhdGFiYXNlJywgW25hbWVdKTtcblx0XHR9XG5cdH07XG5cblx0aWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBleHA7XG5cdFx0bW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IG1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdGVsc2Uge1xuXHRcdHNlbGYuaWRiID0gZXhwO1xuXHR9XG59KCkpO1xuIiwidmFyIEFQSV9VUkwgPSAnaHR0cDovL2xvY2FsaG9zdDoxMzM3L3Jlc3RhdXJhbnRzJztcbnZhciBmZXRjaFN0YXR1cyA9IDA7XG52YXIgcmV2aWV3c0ZldGNoU3RhdHVzID0gMDtcbnZhciBEQl9WRVJTSU9OID0gMTtcblxuLy8gSGVscGVyIEZ1bmN0aW9ucyBmb3IgdmFyaW91cyBJRGIgT3BlcmF0aW9uc1xuY2xhc3MgSURiT3BlcmF0aW9uc0hlbHBlciB7XG5cdHN0YXRpYyBjaGVja0ZvcklEYlN1cHBvcnQoKSB7XG5cdFx0aWYgKCEoJ2luZGV4ZWREQicgaW4gd2luZG93KSkge1xuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiAxO1xuXHRcdH1cblx0fVxuXG5cdHN0YXRpYyBvcGVuSURiKG5hbWUsIHZlcnNpb24sIG9iamVjdFN0b3JlTmFtZSkge1xuXHRcdHZhciBkYlByb21pc2UgPSBpZGIub3BlbihuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlREIgPT4ge1xuXHRcdFx0dXBncmFkZURCLmNyZWF0ZU9iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZSwgeyBhdXRvSW5jcmVtZW50OiB0cnVlIH0pO1xuXHRcdH0pO1xuXHRcdHJldHVybiBkYlByb21pc2U7XG5cdH1cblxuXHRzdGF0aWMgYWRkVG9EYihkYlByb21pc2UsIG9iamVjdFN0b3JlTmFtZSwgcGVybWlzaW9uLCBqc29uRGF0YSkge1xuXHRcdGRiUHJvbWlzZS50aGVuKGRiID0+IHtcblx0XHRcdHZhciB0cmFuc2FjdCA9IGRiLnRyYW5zYWN0aW9uKG9iamVjdFN0b3JlTmFtZSwgcGVybWlzaW9uKTtcblx0XHRcdC8vQWRkIGFsbCB0aGUganNvbiBjb250ZW50IGhlcmVcblx0XHRcdHRyYW5zYWN0Lm9iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZSkucHV0KGpzb25EYXRhKTtcblx0XHRcdHJldHVybiB0cmFuc2FjdC5jb21wbGV0ZTtcblx0XHR9KS50aGVuKHJlc3BvbnNlID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKCdSZXN0YXVyYW50IHNhdmVkIHRvIElEQicpO1xuXHRcdH0pO1xuXHR9XG5cblx0c3RhdGljIGdldEFsbERhdGEoZGJQcm9taXNlLCB0cmFuc2FjdGlvbk5hbWUsIG9iamVjdFN0b3JlTmFtZSkge1xuXHRcdHZhciByZXNwb25zZUFycmF5UHJvbWlzZSA9IGRiUHJvbWlzZS50aGVuKGRiID0+IGRiXG5cdFx0XHQudHJhbnNhY3Rpb24odHJhbnNhY3Rpb25OYW1lKVxuXHRcdFx0Lm9iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZSlcblx0XHRcdC5nZXRBbGwoKVxuXHRcdCk7XG5cdFx0cmVzcG9uc2VBcnJheVByb21pc2UudGhlbihhcnJ5ID0+IHtcblx0XHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuc2V0UmVzdGF1cmFudHNEYXRhKGFycnkpO1xuXHRcdH0pO1xuXHR9XG5cblx0c3RhdGljIGdldERhdGFGcm9tU2VydmVyKGRiUHJvbWlzZSwgb2JqZWN0U3RvcmVOYW1lLCBwZXJtaXNpb24sIGNhbGxiYWNrKSB7XG5cdFx0ZmV0Y2goQVBJX1VSTClcblx0XHRcdC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcblx0XHRcdC50aGVuKHJlc3BvbnNlSnNvbiA9PiB7XG5cdFx0XHRcdHJlc3BvbnNlSnNvbi5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuXHRcdFx0XHRcdHJlc3RhdXJhbnQgPSBJRGJPcGVyYXRpb25zSGVscGVyLmFkZE1pc3NpbmdEYXRhKHJlc3RhdXJhbnQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAoZmV0Y2hTdGF0dXMgIT0gMSkge1xuXHRcdFx0XHRcdGZldGNoU3RhdHVzID0gMTtcblx0XHRcdFx0XHRyZXNwb25zZUpzb24uZm9yRWFjaChyZXN0YXVyYW50RGF0YSA9PiB7XG5cdFx0XHRcdFx0XHQvL0FkZCBldmVyeSBzaW5nbGUgcmVzdGF1cmFudCBkYXRhIHRvIElEYlxuXHRcdFx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5hZGRUb0RiKFxuXHRcdFx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0XHRcdG9iamVjdFN0b3JlTmFtZSxcblx0XHRcdFx0XHRcdFx0cGVybWlzaW9uLFxuXHRcdFx0XHRcdFx0XHRyZXN0YXVyYW50RGF0YVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhyZXNwb25zZUpzb24pO1xuXHRcdFx0XHRjYWxsYmFjayAobnVsbCwgcmVzcG9uc2VKc29uKTtcblx0XHRcdH0pLmNhdGNoKGVycm9yID0+IHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coYFVuYWJsZSB0byBmZXRjaCByZXN0YXVyYW50cywgRXJyb3I6ICR7ZXJyb3J9YCk7XG5cdFx0XHRcdGNhbGxiYWNrIChlcnJvciwgbnVsbCk7XG5cdFx0XHR9KTtcblx0fVxuXG5cdHN0YXRpYyBnZXRSZXN0YXVyYW50c0RhdGEoY2FsbGJhY2spIHtcblx0XHR2YXIgaWRiTmFtZSA9ICdyZXN0YXVyYW50cy1kYXRhJztcblx0XHR2YXIgZGJWZXJzaW9uID0gREJfVkVSU0lPTjtcblx0XHR2YXIgb2JqZWN0U3RvcmVOYW1lU3RyaW5nID0gJ3Jlc3RhdXJhbnRzJztcblx0XHR2YXIgdHJhbnNhY3Rpb25OYW1lU3RyaW5nID0gJ3Jlc3RhdXJhbnRzJztcblx0XHR2YXIgZGJQZXJtaXNzaW9uID0gJ3JlYWR3cml0ZSc7XG5cblx0XHR2YXIgZGJQcm9taXNlID0gSURiT3BlcmF0aW9uc0hlbHBlci5vcGVuSURiKFxuXHRcdFx0aWRiTmFtZSxcblx0XHRcdGRiVmVyc2lvbixcblx0XHRcdG9iamVjdFN0b3JlTmFtZVN0cmluZ1xuXHRcdCk7XG5cblx0XHRkYlByb21pc2UudGhlbihkYiA9PlxuXHRcdFx0ZGIudHJhbnNhY3Rpb24odHJhbnNhY3Rpb25OYW1lU3RyaW5nKVxuXHRcdFx0XHQub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lU3RyaW5nKVxuXHRcdFx0XHQuZ2V0QWxsKClcblx0XHQpLnRoZW4ocmVzcG9uc2VPYmVqY3RzID0+IHtcblx0XHRcdGlmIChyZXNwb25zZU9iZWpjdHMubGVuZ3RoIDw9IDApIHtcblx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXREYXRhRnJvbVNlcnZlcihcblx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0b2JqZWN0U3RvcmVOYW1lU3RyaW5nLFxuXHRcdFx0XHRcdGRiUGVybWlzc2lvbixcblx0XHRcdFx0XHRjYWxsYmFja1xuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzcG9uc2VPYmVqY3RzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qIEZBSUxFRDo6OiBGdW5jdGlvbiB0byB1cGRhdGUgdGhlIFJlc3RhdXJhbnQgZGF0YSovXG5cdHN0YXRpYyB1cGRhdGVSZXN0YXVyYW50RGF0YShyZXN0YXVyYW50KSB7XG5cdFx0dmFyIGlkYk5hbWUgPSAncmVzdGF1cmFudHMtZGF0YSc7XG5cdFx0dmFyIGRiVmVyc2lvbiA9IERCX1ZFUlNJT047XG5cdFx0dmFyIG9iamVjdFN0b3JlTmFtZSA9ICdyZXN0YXVyYW50cyc7XG5cdFx0dmFyIHRyYW5zYWN0aW9uTmFtZSA9ICdyZXN0YXVyYW50cyc7XG5cdFx0dmFyIGRiUGVybWlzc2lvbiA9ICdyZWFkd3JpdGUnO1xuXG5cdFx0dmFyIGRiUHJvbWlzZSA9IElEYk9wZXJhdGlvbnNIZWxwZXIub3BlbklEYihcblx0XHRcdGlkYk5hbWUsXG5cdFx0XHRkYlZlcnNpb24sXG5cdFx0XHRvYmplY3RTdG9yZU5hbWVcblx0XHQpO1xuXG5cdFx0LyogUHV0IEpTT04gZGF0YSB0byBpbmRleERCKi9cblx0XHRkYlByb21pc2UudGhlbihkYiA9PiB7XG5cdFx0XHQgcmV0dXJuIGRiLnRyYW5zYWN0aW9uKG9iamVjdFN0b3JlTmFtZSwgZGJQZXJtaXNzaW9uKVxuXHRcdFx0Lm9iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZSlcblx0XHRcdC5wdXQocmVzdGF1cmFudClcblx0XHR9XG5cdFx0KS50aGVuKHJlcyA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZygndGVzdCBzdWNjZXNzJyk7XG5cdFx0XHRjb25zb2xlLmxvZyhyZXMpO1xuXHRcdH0pLmNhdGNoKGVyciA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZygndGVzdCBmYWlsZWQnKTtcblx0XHRcdGNvbnNvbGUubG9nKGVycik7XG5cdFx0fSk7XG5cdH1cblxuXHQvLyBIYW5kbGUgZm9yIGxhc3QgZW50cnkgb24gUmVzdGF1cmFudHMgTGlzdFxuXHRzdGF0aWMgYWRkTWlzc2luZ0RhdGEocmVzdEpzb24pIHtcblx0XHRpZiAoIWlzTmFOKHJlc3RKc29uLnBob3RvZ3JhcGgpKSB7XG5cdFx0XHRyZXN0SnNvbi5waG90b2dyYXBoID0gcmVzdEpzb24ucGhvdG9ncmFwaCArICcuanBnJztcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmVzdEpzb25bJ3Bob3RvZ3JhcGgnXSA9IHJlc3RKc29uLmlkICsgJy5qcGcnO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzdEpzb247XG5cdH1cblxuXHQvKiBGZXRjaCBBbGwgcmV2aWV3cyBmcm9tIHNlcnZlciBhbmQgc2F2ZSB0byBJbmRleERCIE9iamVjdFN0b3JlKi9cblx0c3RhdGljIGdldFJldmlld3NGcm9tU2VydmVyKGRiUHJvbWlzZSwgb2JqZWN0U3RvcmVOYW1lLCBwZXJtaXNpb24sIGNhbGxiYWNrKSB7XG5cdFx0ZmV0Y2goYGh0dHA6Ly9sb2NhbGhvc3Q6MTMzNy9yZXZpZXdzL2ApXG5cdFx0XHQudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG5cdFx0XHQudGhlbihyZXNwb25zZUpzb24gPT4ge1xuXHRcdFx0XHQvLyBTb3J0IGJ5IHJlc3RhdXJhbnQgSURcblx0XHRcdFx0Ly8gcmVzcG9uc2VKc29uLnNvcnQoKGEsYikgPT4gYS5yZXN0YXVyYW50X2lkIC0gYi5yZXN0YXVyYW50X2lkKTtcblxuXHRcdFx0XHQvLyBBZGQgUmV2aWV3cyBpbiBJbmRleERCIGlmIG5vdCBhZGRlZCBiZWZvcmVcblx0XHRcdFx0aWYgKHJldmlld3NGZXRjaFN0YXR1cyAhPSAxKSB7XG5cdFx0XHRcdFx0cmV2aWV3c0ZldGNoU3RhdHVzID0gMTtcblx0XHRcdFx0XHRyZXNwb25zZUpzb24uZm9yRWFjaChyZXN0YXVyYW50RGF0YSA9PiB7XG5cdFx0XHRcdFx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmFkZFRvRGIoXG5cdFx0XHRcdFx0XHRcdGRiUHJvbWlzZSxcblx0XHRcdFx0XHRcdFx0b2JqZWN0U3RvcmVOYW1lLFxuXHRcdFx0XHRcdFx0XHRwZXJtaXNpb24sXG5cdFx0XHRcdFx0XHRcdHJlc3RhdXJhbnREYXRhXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhbGxiYWNrIChudWxsLCByZXNwb25zZUpzb24pO1xuXHRcdFx0fSkuY2F0Y2goZXJyb3IgPT4ge1xuXHRcdFx0XHRjYWxsYmFjayAoZXJyb3IsIG51bGwpO1xuXHRcdFx0fSk7XG5cdH1cblxuXHRzdGF0aWMgZ2V0UmV2aWV3c0RhdGEoY2FsbGJhY2spIHtcblx0XHR2YXIgaWRiTmFtZSA9ICdyZXN0YXVyYW50cy1kYXRhJztcblx0XHR2YXIgZGJWZXJzaW9uID0gREJfVkVSU0lPTjtcblx0XHR2YXIgb2JqZWN0U3RvcmVOYW1lU3RyaW5nID0gJ3Jldmlld3MnO1xuXHRcdHZhciB0cmFuc2FjdGlvbk5hbWVTdHJpbmcgPSAncmV2aWV3cyc7XG5cdFx0dmFyIGRiUGVybWlzc2lvbiA9ICdyZWFkd3JpdGUnO1xuXG5cdFx0dmFyIGRiUHJvbWlzZSA9IElEYk9wZXJhdGlvbnNIZWxwZXIub3BlbklEYihcblx0XHRcdGlkYk5hbWUsXG5cdFx0XHRkYlZlcnNpb24sXG5cdFx0XHRvYmplY3RTdG9yZU5hbWVTdHJpbmdcblx0XHQpO1xuXG5cdFx0ZGJQcm9taXNlLnRoZW4oZGIgPT5cblx0XHRcdGRiLnRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uTmFtZVN0cmluZywgZGJQZXJtaXNzaW9uKVxuXHRcdFx0XHQub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lU3RyaW5nKVxuXHRcdFx0XHQuZ2V0QWxsKClcblx0XHQpLnRoZW4ocmVzcG9uc2VPYmVqY3RzID0+IHtcblx0XHRcdGlmIChyZXNwb25zZU9iZWpjdHMubGVuZ3RoIDw9IDApIHtcblx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXZpZXdzRnJvbVNlcnZlcihcblx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0b2JqZWN0U3RvcmVOYW1lU3RyaW5nLFxuXHRcdFx0XHRcdGRiUGVybWlzc2lvbixcblx0XHRcdFx0XHRjYWxsYmFja1xuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzcG9uc2VPYmVqY3RzKTtcblx0XHRcdH1cblx0XHR9KS5jYXRjaChlcnIgPT4ge1xuXHRcdFx0Y2FsbGJhY2soZXJyLCBudWxsKTtcblx0XHR9KTtcblx0fVxuXG59XG4iLCIvLyBDb21tb24gZGF0YWJhc2UgaGVscGVyIGZ1bmN0aW9ucy5cbmNsYXNzIERCSGVscGVyIHtcblx0c3RhdGljIGdldCBORVdfVVJMKCkge1xuXHRcdHJldHVybiAnaHR0cDovL2xvY2FsaG9zdDoxMzM3L3Jlc3RhdXJhbnRzJztcblx0fVxuXHQvKipcbiAgICAgKiBGZXRjaCBhIHJlc3RhdXJhbnQgYnkgaXRzIElELlxuICAgICAqL1xuXHRzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcblx0XHQvLyBmZXRjaCBhbGwgcmVzdGF1cmFudHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IHJlc3RhdXJhbnQgPSByZXN0YXVyYW50cy5maW5kKHIgPT4gci5pZCA9PSBpZCk7XG5cdFx0XHRcdGlmIChyZXN0YXVyYW50KSB7XG5cdFx0XHRcdFx0Ly8gR290IHRoZSByZXN0YXVyYW50XG5cdFx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gUmVzdGF1cmFudCBkb2VzIG5vdCBleGlzdCBpbiB0aGUgZGF0YWJhc2Vcblx0XHRcdFx0XHRjYWxsYmFjaygnUmVzdGF1cmFudCBkb2VzIG5vdCBleGlzdCcsIG51bGwpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAgICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICAgKi9cblx0c3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZShjdWlzaW5lLCBjYWxsYmFjaykge1xuXHRcdC8vIEZldGNoIGFsbCByZXN0YXVyYW50cyAgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmdcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBjdWlzaW5lIHR5cGVcblx0XHRcdFx0Y29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuICAgICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuICAgICAqL1xuXHRzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlOZWlnaGJvcmhvb2QobmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xuXHRcdC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xuXHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuZ2V0UmVzdGF1cmFudHNEYXRhKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIG5laWdoYm9yaG9vZFxuXHRcdFx0XHRjb25zdCByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAgICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuICAgICAqL1xuXHRzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKFxuXHRcdGN1aXNpbmUsXG5cdFx0bmVpZ2hib3Job29kLFxuXHRcdGNhbGxiYWNrXG5cdCkge1xuXHRcdC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xuXHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuZ2V0UmVzdGF1cmFudHNEYXRhKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRsZXQgcmVzdWx0cyA9IHJlc3RhdXJhbnRzO1xuXHRcdFx0XHRpZiAoY3Vpc2luZSAhPSAnYWxsJykge1xuXHRcdFx0XHRcdC8vIGZpbHRlciBieSBjdWlzaW5lXG5cdFx0XHRcdFx0cmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKG5laWdoYm9yaG9vZCAhPSAnYWxsJykge1xuXHRcdFx0XHRcdC8vIGZpbHRlciBieSBuZWlnaGJvcmhvb2Rcblx0XHRcdFx0XHRyZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG4gICAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG4gICAgICovXG5cdHN0YXRpYyBmZXRjaE5laWdoYm9yaG9vZHMoY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gR2V0IGFsbCBuZWlnaGJvcmhvb2RzIGZyb20gYWxsIHJlc3RhdXJhbnRzXG5cdFx0XHRcdGNvbnN0IG5laWdoYm9yaG9vZHMgPSByZXN0YXVyYW50cy5tYXAoXG5cdFx0XHRcdFx0KHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLm5laWdoYm9yaG9vZFxuXHRcdFx0XHQpO1xuXHRcdFx0XHQvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcblx0XHRcdFx0Y29uc3QgdW5pcXVlTmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHMuZmlsdGVyKFxuXHRcdFx0XHRcdCh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCB1bmlxdWVOZWlnaGJvcmhvb2RzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuICAgICAqIEZldGNoIGFsbCBjdWlzaW5lcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICAgKi9cblx0c3RhdGljIGZldGNoQ3Vpc2luZXMoY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xuXHRcdFx0XHRjb25zdCBjdWlzaW5lcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0uY3Vpc2luZV90eXBlKTtcblx0XHRcdFx0Ly8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBjdWlzaW5lc1xuXHRcdFx0XHRjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcihcblx0XHRcdFx0XHQodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHVuaXF1ZUN1aXNpbmVzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuICAgICAqIFJlc3RhdXJhbnQgcGFnZSBVUkwuXG4gICAgICovXG5cdHN0YXRpYyB1cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcblx0XHRyZXR1cm4gYC4vcmVzdGF1cmFudC5odG1sP2lkPSR7cmVzdGF1cmFudC5pZH1gO1xuXHR9XG5cblx0LyoqXG4gICAgICogUmVzdGF1cmFudCBpbWFnZSBVUkwuXG4gICAgICovXG5cdHN0YXRpYyBpbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xuXHRcdHJldHVybiBgL2ltZy8ke3Jlc3RhdXJhbnQucGhvdG9ncmFwaH1gO1xuXHR9XG5cblx0LyoqXG4gICAgICogTWFwIG1hcmtlciBmb3IgYSByZXN0YXVyYW50LlxuICAgICAqL1xuXHRzdGF0aWMgbWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBtYXApIHtcblx0XHRjb25zdCBtYXJrZXIgPSBuZXcgTC5tYXJrZXIoXG5cdFx0XHRbcmVzdGF1cmFudC5sYXRsbmcubGF0LCByZXN0YXVyYW50LmxhdGxuZy5sbmddLFxuXHRcdFx0e1xuXHRcdFx0XHR0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxuXHRcdFx0XHRhbHQ6IHJlc3RhdXJhbnQubmFtZSxcblx0XHRcdFx0dXJsOiBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpXG5cdFx0XHR9XG5cdFx0KTtcblx0XHRtYXJrZXIuYWRkVG8obmV3TWFwKTtcblx0XHRyZXR1cm4gbWFya2VyO1xuXHR9XG5cblx0LyogR2V0IHJldmlld3MgZm9yIGEgcmVzdGF1cmFudCovXG5cdHN0YXRpYyBmZXRjaFJldmlld3NGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnRfaWQsIGNhbGxiYWNrKSB7XG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXZpZXdzRGF0YSgoZXJyb3IsIGFsbFJldmlld3MpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRsZXQgcmV2aWV3cyA9IGFsbFJldmlld3MuZmlsdGVyKHIgPT4gci5yZXN0YXVyYW50X2lkID09IHJlc3RhdXJhbnRfaWQpO1xuXHRcdFx0XHRpZiAocmV2aWV3cykge1xuXHRcdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJldmlld3MpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNhbGxiYWNrKCdSZXZpZXcgZG9lcyBub3QgZXhpc3QnLCBudWxsKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59XG4iXSwiZmlsZSI6ImFwcC1taW4uanMifQ==
