navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("*** Service Worker registered ***")}).catch(function(e){console.log(e)}),function(){function e(e){return new Promise(function(t,r){e.onsuccess=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function t(t,r,n){var o,a=new Promise(function(a,s){e(o=t[r].apply(t,n)).then(a,s)});return a.request=o,a}function r(e,t,r){r.forEach(function(r){Object.defineProperty(e.prototype,r,{get:function(){return this[t][r]},set:function(e){this[t][r]=e}})})}function n(e,r,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return t(this[r],o,arguments)})})}function o(e,t,r,n){n.forEach(function(n){n in r.prototype&&(e.prototype[n]=function(){return this[t][n].apply(this[t],arguments)})})}function a(e,r,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return e=this[r],(n=t(e,o,arguments)).then(function(e){if(e)return new i(e,n.request)});var e,n})})}function s(e){this._index=e}function i(e,t){this._cursor=e,this._request=t}function u(e){this._store=e}function c(e){this._tx=e,this.complete=new Promise(function(t,r){e.oncomplete=function(){t()},e.onerror=function(){r(e.error)},e.onabort=function(){r(e.error)}})}function l(e,t,r){this._db=e,this.oldVersion=t,this.transaction=new c(r)}function p(e){this._db=e}r(s,"_index",["name","keyPath","multiEntry","unique"]),n(s,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(s,"_index",IDBIndex,["openCursor","openKeyCursor"]),r(i,"_cursor",["direction","key","primaryKey","value"]),n(i,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(i.prototype[t]=function(){var r=this,n=arguments;return Promise.resolve().then(function(){return r._cursor[t].apply(r._cursor,n),e(r._request).then(function(e){if(e)return new i(e,r._request)})})})}),u.prototype.createIndex=function(){return new s(this._store.createIndex.apply(this._store,arguments))},u.prototype.index=function(){return new s(this._store.index.apply(this._store,arguments))},r(u,"_store",["name","keyPath","indexNames","autoIncrement"]),n(u,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),a(u,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(u,"_store",IDBObjectStore,["deleteIndex"]),c.prototype.objectStore=function(){return new u(this._tx.objectStore.apply(this._tx,arguments))},r(c,"_tx",["objectStoreNames","mode"]),o(c,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new u(this._db.createObjectStore.apply(this._db,arguments))},r(l,"_db",["name","version","objectStoreNames"]),o(l,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new c(this._db.transaction.apply(this._db,arguments))},r(p,"_db",["name","version","objectStoreNames"]),o(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[u,s].forEach(function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t,r=(t=arguments,Array.prototype.slice.call(t)),n=r[r.length-1],o=this._store||this._index,a=o[e].apply(o,r.slice(0,-1));a.onsuccess=function(){n(a.result)}})})}),[s,u].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var r=this,n=[];return new Promise(function(o){r.iterateCursor(e,function(e){e?(n.push(e.value),void 0===t||n.length!=t?e.continue():o(n)):o(n)})})})});var h={open:function(e,r,n){var o=t(indexedDB,"open",[e,r]),a=o.request;return a&&(a.onupgradeneeded=function(e){n&&n(new l(a.result,e.oldVersion,a.transaction))}),o.then(function(e){return new p(e)})},delete:function(e){return t(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=h,module.exports.default=module.exports):self.idb=h}();var API_URL="http://localhost:1337/restaurants",fetchStatus=0,reviewsFetchStatus=0,DB_VERSION=2;class IDbOperationsHelper{static checkForIDbSupport(){return"indexedDB"in window?1:0}static openIDb(e,t,r){return idb.open(e,t,e=>{e.createObjectStore(r,{autoIncrement:!0})})}static addToDb(e,t,r,n){e.then(e=>{var o=e.transaction(t,r);return o.objectStore(t).put(n),o.complete}).then(e=>(console.log("Data saved to IDB"),e)).catch(e=>e)}static getAllData(e,t,r){e.then(e=>e.transaction(t).objectStore(r).getAll()).then(e=>{IDbOperationsHelper.setRestaurantsData(e)})}static getDataFromServer(e,t,r,n){fetch(API_URL).then(e=>e.json()).then(o=>{o.forEach(e=>{e=IDbOperationsHelper.addMissingData(e)}),1!=fetchStatus&&(fetchStatus=1,o.forEach(n=>{IDbOperationsHelper.addToDb(e,t,r,n)})),n(null,o)}).catch(e=>{n(e,null)})}static getRestaurantsData(e){var t=DB_VERSION,r=IDbOperationsHelper.openIDb("restaurants-data",t,"restaurants");r.then(e=>e.transaction("restaurants").objectStore("restaurants").getAll()).then(t=>{t.length<=0?IDbOperationsHelper.getDataFromServer(r,"restaurants","readwrite",e):e(null,t)})}static updateRestaurantData(e){var t=DB_VERSION;IDbOperationsHelper.openIDb("restaurants-data",t,"restaurants").then(t=>t.transaction("restaurants","readwrite").objectStore("restaurants").put(e,e.id)).then(e=>{}).catch(e=>{console.log(e)})}static addMissingData(e){return e.photograph||(e.photograph=e.id),e}static getReviewsFromServer(e,t,r,n){fetch("http://localhost:1337/reviews/").then(e=>e.json()).then(o=>{1!=reviewsFetchStatus&&(reviewsFetchStatus=1,o.forEach(n=>{IDbOperationsHelper.addToDb(e,t,r,n)})),n(null,o)}).catch(e=>{n(e,null)})}static getReviewsData(e){var t=DB_VERSION,r=IDbOperationsHelper.openIDb("reviews-data",t,"reviews");r.then(e=>e.transaction("reviews","readwrite").objectStore("reviews").getAll()).then(t=>{t.length<=0?IDbOperationsHelper.getReviewsFromServer(r,"reviews","readwrite",e):e(null,t)}).catch(t=>{e(t,null)})}static addReviewToIdb(e){var t=DB_VERSION,r=IDbOperationsHelper.openIDb("reviews-data",t,"reviews");IDbOperationsHelper.addToDb(r,"reviews","readwrite",e)}}class DBHelper{static get NEW_URL(){return"http://localhost:1337/restaurants"}static fetchRestaurantById(e,t){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)t(r,null);else{const r=n.find(t=>t.id==e);r?t(null,r):t("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(e,t){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)t(r,null);else{const r=n.filter(t=>t.cuisine_type==e);t(null,r)}})}static fetchRestaurantByNeighborhood(e,t){IDbOperationsHelper.getRestaurantsData((r,n)=>{if(r)t(r,null);else{const r=n.filter(t=>t.neighborhood==e);t(null,r)}})}static fetchRestaurantByCuisineAndNeighborhood(e,t,r){IDbOperationsHelper.getRestaurantsData((n,o)=>{if(n)r(n,null);else{let n=o;"all"!=e&&(n=n.filter(t=>t.cuisine_type==e)),"all"!=t&&(n=n.filter(e=>e.neighborhood==t)),r(null,n)}})}static fetchNeighborhoods(e){IDbOperationsHelper.getRestaurantsData((t,r)=>{if(t)e(t,null);else{const t=r.map((e,t)=>r[t].neighborhood),n=t.filter((e,r)=>t.indexOf(e)==r);e(null,n)}})}static fetchCuisines(e){IDbOperationsHelper.getRestaurantsData((t,r)=>{if(t)e(t,null);else{const t=r.map((e,t)=>r[t].cuisine_type),n=t.filter((e,r)=>t.indexOf(e)==r);e(null,n)}})}static urlForRestaurant(e){return`./restaurant.html?id=${e.id}`}static imageUrlForRestaurant(e){return`/img/${e.photograph}.jpg`}static mapMarkerForRestaurant(e,t){const r=new L.marker([e.latlng.lat,e.latlng.lng],{title:e.name,alt:e.name,url:DBHelper.urlForRestaurant(e)});return r.addTo(newMap),r}static fetchReviewsForRestaurant(e,t){IDbOperationsHelper.getReviewsData((r,n)=>{if(r)t(r,null);else{let r=n.filter(t=>t.restaurant_id==e);r?t(null,r):t("Review does not exist",null)}})}static addReviewForRestaurant(e,t){IDbOperationsHelper.addReviewToIdb(e),t("Review added to IDB")}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4Q29udHJvbGxlci5qcyIsImlkYi5qcyIsIklEYk9wZXJhdGlvbnNIZWxwZXIuanMiLCJkYmhlbHBlci5qcyJdLCJuYW1lcyI6WyJuYXZpZ2F0b3IiLCJzZXJ2aWNlV29ya2VyIiwicmVnaXN0ZXIiLCJ0aGVuIiwicmVnIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyIiwicHJvbWlzaWZ5UmVxdWVzdCIsInJlcXVlc3QiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uc3VjY2VzcyIsInJlc3VsdCIsIm9uZXJyb3IiLCJlcnJvciIsInByb21pc2lmeVJlcXVlc3RDYWxsIiwib2JqIiwibWV0aG9kIiwiYXJncyIsInAiLCJhcHBseSIsInByb3h5UHJvcGVydGllcyIsIlByb3h5Q2xhc3MiLCJ0YXJnZXRQcm9wIiwicHJvcGVydGllcyIsImZvckVhY2giLCJwcm9wIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b3R5cGUiLCJnZXQiLCJ0aGlzIiwic2V0IiwidmFsIiwicHJveHlSZXF1ZXN0TWV0aG9kcyIsIkNvbnN0cnVjdG9yIiwiYXJndW1lbnRzIiwicHJveHlNZXRob2RzIiwicHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyIsInZhbHVlIiwiQ3Vyc29yIiwiSW5kZXgiLCJpbmRleCIsIl9pbmRleCIsImN1cnNvciIsIl9jdXJzb3IiLCJfcmVxdWVzdCIsIk9iamVjdFN0b3JlIiwic3RvcmUiLCJfc3RvcmUiLCJUcmFuc2FjdGlvbiIsImlkYlRyYW5zYWN0aW9uIiwiX3R4IiwiY29tcGxldGUiLCJvbmNvbXBsZXRlIiwib25hYm9ydCIsIlVwZ3JhZGVEQiIsImRiIiwib2xkVmVyc2lvbiIsInRyYW5zYWN0aW9uIiwiX2RiIiwiREIiLCJJREJJbmRleCIsIklEQkN1cnNvciIsIm1ldGhvZE5hbWUiLCJjcmVhdGVJbmRleCIsIklEQk9iamVjdFN0b3JlIiwib2JqZWN0U3RvcmUiLCJJREJUcmFuc2FjdGlvbiIsImNyZWF0ZU9iamVjdFN0b3JlIiwiSURCRGF0YWJhc2UiLCJmdW5jTmFtZSIsInJlcGxhY2UiLCJhcnIiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsImNhbGxiYWNrIiwibGVuZ3RoIiwibmF0aXZlT2JqZWN0IiwiZ2V0QWxsIiwicXVlcnkiLCJjb3VudCIsImluc3RhbmNlIiwiaXRlbXMiLCJpdGVyYXRlQ3Vyc29yIiwicHVzaCIsInVuZGVmaW5lZCIsImNvbnRpbnVlIiwiZXhwIiwib3BlbiIsIm5hbWUiLCJ2ZXJzaW9uIiwidXBncmFkZUNhbGxiYWNrIiwiaW5kZXhlZERCIiwib251cGdyYWRlbmVlZGVkIiwiZXZlbnQiLCJkZWxldGUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZGVmYXVsdCIsInNlbGYiLCJpZGIiLCJBUElfVVJMIiwiZmV0Y2hTdGF0dXMiLCJyZXZpZXdzRmV0Y2hTdGF0dXMiLCJEQl9WRVJTSU9OIiwiSURiT3BlcmF0aW9uc0hlbHBlciIsIltvYmplY3QgT2JqZWN0XSIsIndpbmRvdyIsIm9iamVjdFN0b3JlTmFtZSIsInVwZ3JhZGVEQiIsImF1dG9JbmNyZW1lbnQiLCJkYlByb21pc2UiLCJwZXJtaXNpb24iLCJqc29uRGF0YSIsInRyYW5zYWN0IiwicHV0IiwicmVzcG9uc2UiLCJ0cmFuc2FjdGlvbk5hbWUiLCJhcnJ5Iiwic2V0UmVzdGF1cmFudHNEYXRhIiwiZmV0Y2giLCJqc29uIiwicmVzcG9uc2VKc29uIiwicmVzdGF1cmFudCIsImFkZE1pc3NpbmdEYXRhIiwicmVzdGF1cmFudERhdGEiLCJhZGRUb0RiIiwiZGJWZXJzaW9uIiwib3BlbklEYiIsInJlc3BvbnNlT2JlamN0cyIsImdldERhdGFGcm9tU2VydmVyIiwiaWQiLCJyZXMiLCJyZXN0SnNvbiIsInBob3RvZ3JhcGgiLCJnZXRSZXZpZXdzRnJvbVNlcnZlciIsInJldmlld0RhdGEiLCJEQkhlbHBlciIsIk5FV19VUkwiLCJnZXRSZXN0YXVyYW50c0RhdGEiLCJyZXN0YXVyYW50cyIsImZpbmQiLCJyIiwiY3Vpc2luZSIsInJlc3VsdHMiLCJmaWx0ZXIiLCJjdWlzaW5lX3R5cGUiLCJuZWlnaGJvcmhvb2QiLCJuZWlnaGJvcmhvb2RzIiwibWFwIiwidiIsImkiLCJ1bmlxdWVOZWlnaGJvcmhvb2RzIiwiaW5kZXhPZiIsImN1aXNpbmVzIiwidW5pcXVlQ3Vpc2luZXMiLCJtYXJrZXIiLCJMIiwibGF0bG5nIiwibGF0IiwibG5nIiwidGl0bGUiLCJhbHQiLCJ1cmwiLCJ1cmxGb3JSZXN0YXVyYW50IiwiYWRkVG8iLCJuZXdNYXAiLCJyZXN0YXVyYW50X2lkIiwiZ2V0UmV2aWV3c0RhdGEiLCJhbGxSZXZpZXdzIiwicmV2aWV3cyIsImFkZFJldmlld1RvSWRiIl0sIm1hcHBpbmdzIjoiQUFBSUEsVUFBVUMsZUFDYkQsVUFBVUMsY0FBY0MsU0FBUyxVQUFVQyxLQUFLQyxJQUMvQ0MsUUFBUUMsSUFBSSx1Q0FDVkMsTUFBTSxTQUFTQyxHQUNqQkgsUUFBUUMsSUFBSUUsS0FNYixXQUtBLFNBQVNDLEVBQWlCQyxHQUN6QixPQUFPLElBQUlDLFFBQVEsU0FBU0MsRUFBU0MsR0FDcENILEVBQVFJLFVBQVksV0FDbkJGLEVBQVFGLEVBQVFLLFNBR2pCTCxFQUFRTSxRQUFVLFdBQ2pCSCxFQUFPSCxFQUFRTyxVQUtsQixTQUFTQyxFQUFxQkMsRUFBS0MsRUFBUUMsR0FDMUMsSUFBSVgsRUFDQVksRUFBSSxJQUFJWCxRQUFRLFNBQVNDLEVBQVNDLEdBRXJDSixFQURBQyxFQUFVUyxFQUFJQyxHQUFRRyxNQUFNSixFQUFLRSxJQUNQbEIsS0FBS1MsRUFBU0MsS0FJekMsT0FEQVMsRUFBRVosUUFBVUEsRUFDTFksRUFXUixTQUFTRSxFQUFnQkMsRUFBWUMsRUFBWUMsR0FDaERBLEVBQVdDLFFBQVEsU0FBU0MsR0FDM0JDLE9BQU9DLGVBQWVOLEVBQVdPLFVBQVdILEVBQU0sQ0FDakRJLElBQUssV0FDSixPQUFPQyxLQUFLUixHQUFZRyxJQUV6Qk0sSUFBSyxTQUFTQyxHQUNiRixLQUFLUixHQUFZRyxHQUFRTyxPQU03QixTQUFTQyxFQUFvQlos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R0FDekM4QixvQkFBb0JrRSxlQUFlbkMsR0FDbkM3RCxFQUFTIiwic291cmNlc0NvbnRlbnQiOlsiaWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSB7XG5cdG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCcvc3cuanMnKS50aGVuKHJlZyA9PiB7XG5cdFx0Y29uc29sZS5sb2coJyoqKiBTZXJ2aWNlIFdvcmtlciByZWdpc3RlcmVkICoqKicpO1xuXHR9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRjb25zb2xlLmxvZyhlcnIpO1xuXHR9KTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uKCkge1xuXHRmdW5jdGlvbiB0b0FycmF5KGFycikge1xuXHRcdHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0cmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVzb2x2ZShyZXF1ZXN0LnJlc3VsdCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRyZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG5cdFx0dmFyIHJlcXVlc3Q7XG5cdFx0dmFyIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHJlcXVlc3QgPSBvYmpbbWV0aG9kXS5hcHBseShvYmosIGFyZ3MpO1xuXHRcdFx0cHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG5cdFx0fSk7XG5cblx0XHRwLnJlcXVlc3QgPSByZXF1ZXN0O1xuXHRcdHJldHVybiBwO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcblx0XHR2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKTtcblx0XHRyZXR1cm4gcC50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRpZiAoIXZhbHVlKSByZXR1cm47XG5cdFx0XHRyZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgcC5yZXF1ZXN0KTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb3h5UHJvcGVydGllcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBwcm9wZXJ0aWVzKSB7XG5cdFx0cHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eUNsYXNzLnByb3RvdHlwZSwgcHJvcCwge1xuXHRcdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZXQ6IGZ1bmN0aW9uKHZhbCkge1xuXHRcdFx0XHRcdHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0gPSB2YWw7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJveHlSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuXHRcdHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG5cdFx0XHRpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblx0XHRcdFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb3h5TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuXHRcdHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG5cdFx0XHRpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblx0XHRcdFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdLmFwcGx5KHRoaXNbdGFyZ2V0UHJvcF0sIGFyZ3VtZW50cyk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuXHRcdHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG5cdFx0XHRpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblx0XHRcdFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIEluZGV4KGluZGV4KSB7XG5cdFx0dGhpcy5faW5kZXggPSBpbmRleDtcblx0fVxuXG5cdHByb3h5UHJvcGVydGllcyhJbmRleCwgJ19pbmRleCcsIFtcblx0XHQnbmFtZScsXG5cdFx0J2tleVBhdGgnLFxuXHRcdCdtdWx0aUVudHJ5Jyxcblx0XHQndW5pcXVlJ1xuXHRdKTtcblxuXHRwcm94eVJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcblx0XHQnZ2V0Jyxcblx0XHQnZ2V0S2V5Jyxcblx0XHQnZ2V0QWxsJyxcblx0XHQnZ2V0QWxsS2V5cycsXG5cdFx0J2NvdW50J1xuXHRdKTtcblxuXHRwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcblx0XHQnb3BlbkN1cnNvcicsXG5cdFx0J29wZW5LZXlDdXJzb3InXG5cdF0pO1xuXG5cdGZ1bmN0aW9uIEN1cnNvcihjdXJzb3IsIHJlcXVlc3QpIHtcblx0XHR0aGlzLl9jdXJzb3IgPSBjdXJzb3I7XG5cdFx0dGhpcy5fcmVxdWVzdCA9IHJlcXVlc3Q7XG5cdH1cblxuXHRwcm94eVByb3BlcnRpZXMoQ3Vyc29yLCAnX2N1cnNvcicsIFtcblx0XHQnZGlyZWN0aW9uJyxcblx0XHQna2V5Jyxcblx0XHQncHJpbWFyeUtleScsXG5cdFx0J3ZhbHVlJ1xuXHRdKTtcblxuXHRwcm94eVJlcXVlc3RNZXRob2RzKEN1cnNvciwgJ19jdXJzb3InLCBJREJDdXJzb3IsIFtcblx0XHQndXBkYXRlJyxcblx0XHQnZGVsZXRlJ1xuXHRdKTtcblxuXHQvLyBwcm94eSAnbmV4dCcgbWV0aG9kc1xuXHRbJ2FkdmFuY2UnLCAnY29udGludWUnLCAnY29udGludWVQcmltYXJ5S2V5J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2ROYW1lKSB7XG5cdFx0aWYgKCEobWV0aG9kTmFtZSBpbiBJREJDdXJzb3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXHRcdEN1cnNvci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBjdXJzb3IgPSB0aGlzO1xuXHRcdFx0dmFyIGFyZ3MgPSBhcmd1bWVudHM7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpIHtcblx0XHRcdFx0Y3Vyc29yLl9jdXJzb3JbbWV0aG9kTmFtZV0uYXBwbHkoY3Vyc29yLl9jdXJzb3IsIGFyZ3MpO1xuXHRcdFx0XHRyZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdChjdXJzb3IuX3JlcXVlc3QpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0XHRpZiAoIXZhbHVlKSByZXR1cm47XG5cdFx0XHRcdFx0cmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIGN1cnNvci5fcmVxdWVzdCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSk7XG5cblx0ZnVuY3Rpb24gT2JqZWN0U3RvcmUoc3RvcmUpIHtcblx0XHR0aGlzLl9zdG9yZSA9IHN0b3JlO1xuXHR9XG5cblx0T2JqZWN0U3RvcmUucHJvdG90eXBlLmNyZWF0ZUluZGV4ID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5jcmVhdGVJbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG5cdH07XG5cblx0T2JqZWN0U3RvcmUucHJvdG90eXBlLmluZGV4ID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5pbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG5cdH07XG5cblx0cHJveHlQcm9wZXJ0aWVzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgW1xuXHRcdCduYW1lJyxcblx0XHQna2V5UGF0aCcsXG5cdFx0J2luZGV4TmFtZXMnLFxuXHRcdCdhdXRvSW5jcmVtZW50J1xuXHRdKTtcblxuXHRwcm94eVJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcblx0XHQncHV0Jyxcblx0XHQnYWRkJyxcblx0XHQnZGVsZXRlJyxcblx0XHQnY2xlYXInLFxuXHRcdCdnZXQnLFxuXHRcdCdnZXRBbGwnLFxuXHRcdCdnZXRLZXknLFxuXHRcdCdnZXRBbGxLZXlzJyxcblx0XHQnY291bnQnXG5cdF0pO1xuXG5cdHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuXHRcdCdvcGVuQ3Vyc29yJyxcblx0XHQnb3BlbktleUN1cnNvcidcblx0XSk7XG5cblx0cHJveHlNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcblx0XHQnZGVsZXRlSW5kZXgnXG5cdF0pO1xuXG5cdGZ1bmN0aW9uIFRyYW5zYWN0aW9uKGlkYlRyYW5zYWN0aW9uKSB7XG5cdFx0dGhpcy5fdHggPSBpZGJUcmFuc2FjdGlvbjtcblx0XHR0aGlzLmNvbXBsZXRlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRpZGJUcmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdH07XG5cdFx0XHRpZGJUcmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG5cdFx0XHR9O1xuXHRcdFx0aWRiVHJhbnNhY3Rpb24ub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fdHgub2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fdHgsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdHByb3h5UHJvcGVydGllcyhUcmFuc2FjdGlvbiwgJ190eCcsIFtcblx0XHQnb2JqZWN0U3RvcmVOYW1lcycsXG5cdFx0J21vZGUnXG5cdF0pO1xuXG5cdHByb3h5TWV0aG9kcyhUcmFuc2FjdGlvbiwgJ190eCcsIElEQlRyYW5zYWN0aW9uLCBbXG5cdFx0J2Fib3J0J1xuXHRdKTtcblxuXHRmdW5jdGlvbiBVcGdyYWRlREIoZGIsIG9sZFZlcnNpb24sIHRyYW5zYWN0aW9uKSB7XG5cdFx0dGhpcy5fZGIgPSBkYjtcblx0XHR0aGlzLm9sZFZlcnNpb24gPSBvbGRWZXJzaW9uO1xuXHRcdHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xuXHR9XG5cblx0VXBncmFkZURCLnByb3RvdHlwZS5jcmVhdGVPYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fZGIuY3JlYXRlT2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdHByb3h5UHJvcGVydGllcyhVcGdyYWRlREIsICdfZGInLCBbXG5cdFx0J25hbWUnLFxuXHRcdCd2ZXJzaW9uJyxcblx0XHQnb2JqZWN0U3RvcmVOYW1lcydcblx0XSk7XG5cblx0cHJveHlNZXRob2RzKFVwZ3JhZGVEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG5cdFx0J2RlbGV0ZU9iamVjdFN0b3JlJyxcblx0XHQnY2xvc2UnXG5cdF0pO1xuXG5cdGZ1bmN0aW9uIERCKGRiKSB7XG5cdFx0dGhpcy5fZGIgPSBkYjtcblx0fVxuXG5cdERCLnByb3RvdHlwZS50cmFuc2FjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5fZGIudHJhbnNhY3Rpb24uYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdHByb3h5UHJvcGVydGllcyhEQiwgJ19kYicsIFtcblx0XHQnbmFtZScsXG5cdFx0J3ZlcnNpb24nLFxuXHRcdCdvYmplY3RTdG9yZU5hbWVzJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuXHRcdCdjbG9zZSdcblx0XSk7XG5cblx0Ly8gQWRkIGN1cnNvciBpdGVyYXRvcnNcblx0Ly8gVE9ETzogcmVtb3ZlIHRoaXMgb25jZSBicm93c2VycyBkbyB0aGUgcmlnaHQgdGhpbmcgd2l0aCBwcm9taXNlc1xuXHRbJ29wZW5DdXJzb3InLCAnb3BlbktleUN1cnNvciddLmZvckVhY2goZnVuY3Rpb24oZnVuY05hbWUpIHtcblx0XHRbT2JqZWN0U3RvcmUsIEluZGV4XS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG5cdFx0XHQvLyBEb24ndCBjcmVhdGUgaXRlcmF0ZUtleUN1cnNvciBpZiBvcGVuS2V5Q3Vyc29yIGRvZXNuJ3QgZXhpc3QuXG5cdFx0XHRpZiAoIShmdW5jTmFtZSBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG5cblx0XHRcdENvbnN0cnVjdG9yLnByb3RvdHlwZVtmdW5jTmFtZS5yZXBsYWNlKCdvcGVuJywgJ2l0ZXJhdGUnKV0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG5cdFx0XHRcdHZhciBjYWxsYmFjayA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcblx0XHRcdFx0dmFyIG5hdGl2ZU9iamVjdCA9IHRoaXMuX3N0b3JlIHx8IHRoaXMuX2luZGV4O1xuXHRcdFx0XHR2YXIgcmVxdWVzdCA9IG5hdGl2ZU9iamVjdFtmdW5jTmFtZV0uYXBwbHkobmF0aXZlT2JqZWN0LCBhcmdzLnNsaWNlKDAsIC0xKSk7XG5cdFx0XHRcdHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2socmVxdWVzdC5yZXN1bHQpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fSk7XG5cblx0Ly8gcG9seWZpbGwgZ2V0QWxsXG5cdFtJbmRleCwgT2JqZWN0U3RvcmVdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcblx0XHRpZiAoQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCkgcmV0dXJuO1xuXHRcdENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbihxdWVyeSwgY291bnQpIHtcblx0XHRcdHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cdFx0XHR2YXIgaXRlbXMgPSBbXTtcblxuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcblx0XHRcdFx0aW5zdGFuY2UuaXRlcmF0ZUN1cnNvcihxdWVyeSwgZnVuY3Rpb24oY3Vyc29yKSB7XG5cdFx0XHRcdFx0aWYgKCFjdXJzb3IpIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoaXRlbXMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XG5cblx0XHRcdFx0XHRpZiAoY291bnQgIT09IHVuZGVmaW5lZCAmJiBpdGVtcy5sZW5ndGggPT0gY291bnQpIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoaXRlbXMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRjdXJzb3IuY29udGludWUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KTtcblxuXHR2YXIgZXhwID0ge1xuXHRcdG9wZW46IGZ1bmN0aW9uKG5hbWUsIHZlcnNpb24sIHVwZ3JhZGVDYWxsYmFjaykge1xuXHRcdFx0dmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdvcGVuJywgW25hbWUsIHZlcnNpb25dKTtcblx0XHRcdHZhciByZXF1ZXN0ID0gcC5yZXF1ZXN0O1xuXG5cdFx0XHRpZiAocmVxdWVzdCkge1xuXHRcdFx0XHRyZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdFx0aWYgKHVwZ3JhZGVDYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0dXBncmFkZUNhbGxiYWNrKG5ldyBVcGdyYWRlREIocmVxdWVzdC5yZXN1bHQsIGV2ZW50Lm9sZFZlcnNpb24sIHJlcXVlc3QudHJhbnNhY3Rpb24pKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBwLnRoZW4oZnVuY3Rpb24oZGIpIHtcblx0XHRcdFx0cmV0dXJuIG5ldyBEQihkYik7XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdGRlbGV0ZTogZnVuY3Rpb24obmFtZSkge1xuXHRcdFx0cmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ2RlbGV0ZURhdGFiYXNlJywgW25hbWVdKTtcblx0XHR9XG5cdH07XG5cblx0aWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBleHA7XG5cdFx0bW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IG1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdGVsc2Uge1xuXHRcdHNlbGYuaWRiID0gZXhwO1xuXHR9XG59KCkpO1xuIiwidmFyIEFQSV9VUkwgPSAnaHR0cDovL2xvY2FsaG9zdDoxMzM3L3Jlc3RhdXJhbnRzJztcbnZhciBmZXRjaFN0YXR1cyA9IDA7XG52YXIgcmV2aWV3c0ZldGNoU3RhdHVzID0gMDtcbnZhciBEQl9WRVJTSU9OID0gMjtcblxuLy8gSGVscGVyIEZ1bmN0aW9ucyBmb3IgdmFyaW91cyBJRGIgT3BlcmF0aW9uc1xuY2xhc3MgSURiT3BlcmF0aW9uc0hlbHBlciB7XG5cdHN0YXRpYyBjaGVja0ZvcklEYlN1cHBvcnQoKSB7XG5cdFx0aWYgKCEoJ2luZGV4ZWREQicgaW4gd2luZG93KSkge1xuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiAxO1xuXHRcdH1cblx0fVxuXG5cdHN0YXRpYyBvcGVuSURiKG5hbWUsIHZlcnNpb24sIG9iamVjdFN0b3JlTmFtZSkge1xuXHRcdHZhciBkYlByb21pc2UgPSBpZGIub3BlbihuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlREIgPT4ge1xuXHRcdFx0dXBncmFkZURCLmNyZWF0ZU9iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZSwgeyBhdXRvSW5jcmVtZW50OiB0cnVlIH0pO1xuXHRcdH0pO1xuXHRcdHJldHVybiBkYlByb21pc2U7XG5cdH1cblxuXHRzdGF0aWMgYWRkVG9EYihkYlByb21pc2UsIG9iamVjdFN0b3JlTmFtZSwgcGVybWlzaW9uLCBqc29uRGF0YSkge1xuXHRcdGRiUHJvbWlzZS50aGVuKGRiID0+IHtcblx0XHRcdHZhciB0cmFuc2FjdCA9IGRiLnRyYW5zYWN0aW9uKG9iamVjdFN0b3JlTmFtZSwgcGVybWlzaW9uKTtcblx0XHRcdC8vQWRkIGFsbCB0aGUganNvbiBjb250ZW50IGhlcmVcblx0XHRcdHRyYW5zYWN0Lm9iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZSkucHV0KGpzb25EYXRhKTtcblx0XHRcdHJldHVybiB0cmFuc2FjdC5jb21wbGV0ZTtcblx0XHR9KS50aGVuKHJlc3BvbnNlID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKCdEYXRhIHNhdmVkIHRvIElEQicpO1xuXHRcdFx0cmV0dXJuIHJlc3BvbnNlO1xuXHRcdH0pLmNhdGNoKGVyciA9PiB7XG5cdFx0XHRyZXR1cm4gZXJyO1xuXHRcdH0pO1xuXHR9XG5cblx0c3RhdGljIGdldEFsbERhdGEoZGJQcm9taXNlLCB0cmFuc2FjdGlvbk5hbWUsIG9iamVjdFN0b3JlTmFtZSkge1xuXHRcdHZhciByZXNwb25zZUFycmF5UHJvbWlzZSA9IGRiUHJvbWlzZS50aGVuKGRiID0+IGRiXG5cdFx0XHQudHJhbnNhY3Rpb24odHJhbnNhY3Rpb25OYW1lKVxuXHRcdFx0Lm9iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZSlcblx0XHRcdC5nZXRBbGwoKVxuXHRcdCk7XG5cdFx0cmVzcG9uc2VBcnJheVByb21pc2UudGhlbihhcnJ5ID0+IHtcblx0XHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuc2V0UmVzdGF1cmFudHNEYXRhKGFycnkpO1xuXHRcdH0pO1xuXHR9XG5cblx0c3RhdGljIGdldERhdGFGcm9tU2VydmVyKGRiUHJvbWlzZSwgb2JqZWN0U3RvcmVOYW1lLCBwZXJtaXNpb24sIGNhbGxiYWNrKSB7XG5cdFx0ZmV0Y2goQVBJX1VSTClcblx0XHRcdC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcblx0XHRcdC50aGVuKHJlc3BvbnNlSnNvbiA9PiB7XG5cdFx0XHRcdHJlc3BvbnNlSnNvbi5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuXHRcdFx0XHRcdHJlc3RhdXJhbnQgPSBJRGJPcGVyYXRpb25zSGVscGVyLmFkZE1pc3NpbmdEYXRhKHJlc3RhdXJhbnQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAoZmV0Y2hTdGF0dXMgIT0gMSkge1xuXHRcdFx0XHRcdGZldGNoU3RhdHVzID0gMTtcblx0XHRcdFx0XHRyZXNwb25zZUpzb24uZm9yRWFjaChyZXN0YXVyYW50RGF0YSA9PiB7XG5cdFx0XHRcdFx0XHQvL0FkZCBldmVyeSBzaW5nbGUgcmVzdGF1cmFudCBkYXRhIHRvIElEYlxuXHRcdFx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5hZGRUb0RiKFxuXHRcdFx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0XHRcdG9iamVjdFN0b3JlTmFtZSxcblx0XHRcdFx0XHRcdFx0cGVybWlzaW9uLFxuXHRcdFx0XHRcdFx0XHRyZXN0YXVyYW50RGF0YVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhyZXNwb25zZUpzb24pO1xuXHRcdFx0XHRjYWxsYmFjayAobnVsbCwgcmVzcG9uc2VKc29uKTtcblx0XHRcdH0pLmNhdGNoKGVycm9yID0+IHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coYFVuYWJsZSB0byBmZXRjaCByZXN0YXVyYW50cywgRXJyb3I6ICR7ZXJyb3J9YCk7XG5cdFx0XHRcdGNhbGxiYWNrIChlcnJvciwgbnVsbCk7XG5cdFx0XHR9KTtcblx0fVxuXG5cdHN0YXRpYyBnZXRSZXN0YXVyYW50c0RhdGEoY2FsbGJhY2spIHtcblx0XHR2YXIgaWRiTmFtZSA9ICdyZXN0YXVyYW50cy1kYXRhJztcblx0XHR2YXIgZGJWZXJzaW9uID0gREJfVkVSU0lPTjtcblx0XHR2YXIgb2JqZWN0U3RvcmVOYW1lU3RyaW5nID0gJ3Jlc3RhdXJhbnRzJztcblx0XHR2YXIgdHJhbnNhY3Rpb25OYW1lU3RyaW5nID0gJ3Jlc3RhdXJhbnRzJztcblx0XHR2YXIgZGJQZXJtaXNzaW9uID0gJ3JlYWR3cml0ZSc7XG5cblx0XHR2YXIgZGJQcm9taXNlID0gSURiT3BlcmF0aW9uc0hlbHBlci5vcGVuSURiKFxuXHRcdFx0aWRiTmFtZSxcblx0XHRcdGRiVmVyc2lvbixcblx0XHRcdG9iamVjdFN0b3JlTmFtZVN0cmluZ1xuXHRcdCk7XG5cblx0XHRkYlByb21pc2UudGhlbihkYiA9PlxuXHRcdFx0ZGIudHJhbnNhY3Rpb24odHJhbnNhY3Rpb25OYW1lU3RyaW5nKVxuXHRcdFx0XHQub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lU3RyaW5nKVxuXHRcdFx0XHQuZ2V0QWxsKClcblx0XHQpLnRoZW4ocmVzcG9uc2VPYmVqY3RzID0+IHtcblx0XHRcdGlmIChyZXNwb25zZU9iZWpjdHMubGVuZ3RoIDw9IDApIHtcblx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXREYXRhRnJvbVNlcnZlcihcblx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0b2JqZWN0U3RvcmVOYW1lU3RyaW5nLFxuXHRcdFx0XHRcdGRiUGVybWlzc2lvbixcblx0XHRcdFx0XHRjYWxsYmFja1xuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzcG9uc2VPYmVqY3RzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgUmVzdGF1cmFudCBkYXRhLCB1c2luZyAodmFsdWUsIGtleSkqL1xuXHRzdGF0aWMgdXBkYXRlUmVzdGF1cmFudERhdGEocmVzdGF1cmFudCkge1xuXHRcdHZhciBpZGJOYW1lID0gJ3Jlc3RhdXJhbnRzLWRhdGEnO1xuXHRcdHZhciBkYlZlcnNpb24gPSBEQl9WRVJTSU9OO1xuXHRcdHZhciBvYmplY3RTdG9yZU5hbWUgPSAncmVzdGF1cmFudHMnO1xuXHRcdHZhciB0cmFuc2FjdGlvbk5hbWUgPSAncmVzdGF1cmFudHMnO1xuXHRcdHZhciBkYlBlcm1pc3Npb24gPSAncmVhZHdyaXRlJztcblxuXHRcdHZhciBkYlByb21pc2UgPSBJRGJPcGVyYXRpb25zSGVscGVyLm9wZW5JRGIoXG5cdFx0XHRpZGJOYW1lLFxuXHRcdFx0ZGJWZXJzaW9uLFxuXHRcdFx0b2JqZWN0U3RvcmVOYW1lXG5cdFx0KTtcblxuXHRcdC8qIFVwZGF0ZSBKU09OIGRhdGEgdG8gaW5kZXhEQiAqL1xuXHRcdGRiUHJvbWlzZS50aGVuKGRiID0+IHtcblx0XHRcdCByZXR1cm4gZGIudHJhbnNhY3Rpb24ob2JqZWN0U3RvcmVOYW1lLCBkYlBlcm1pc3Npb24pXG5cdFx0XHQub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lKVxuXHRcdFx0LnB1dChyZXN0YXVyYW50LCByZXN0YXVyYW50LmlkKVxuXHRcdH1cblx0XHQpLnRoZW4ocmVzID0+IHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKHJlcyk7XG5cdFx0fSkuY2F0Y2goZXJyID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKGVycik7XG5cdFx0fSk7XG5cdH1cblxuXHQvLyBIYW5kbGUgZm9yIGxhc3QgZW50cnkgb24gUmVzdGF1cmFudHMgTGlzdFxuXHRzdGF0aWMgYWRkTWlzc2luZ0RhdGEocmVzdEpzb24pIHtcblx0XHRpZiAoIXJlc3RKc29uLnBob3RvZ3JhcGgpIHtcblx0XHRcdHJlc3RKc29uLnBob3RvZ3JhcGggPSByZXN0SnNvbi5pZDtcblx0XHR9XG5cdFx0cmV0dXJuIHJlc3RKc29uO1xuXHR9XG5cblx0LyogRmV0Y2ggQWxsIHJldmlld3MgZnJvbSBzZXJ2ZXIgYW5kIHNhdmUgdG8gSW5kZXhEQiBPYmplY3RTdG9yZSovXG5cdHN0YXRpYyBnZXRSZXZpZXdzRnJvbVNlcnZlcihkYlByb21pc2UsIG9iamVjdFN0b3JlTmFtZSwgcGVybWlzaW9uLCBjYWxsYmFjaykge1xuXHRcdGZldGNoKGBodHRwOi8vbG9jYWxob3N0OjEzMzcvcmV2aWV3cy9gKVxuXHRcdFx0LnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuXHRcdFx0LnRoZW4ocmVzcG9uc2VKc29uID0+IHtcblx0XHRcdFx0Ly8gU29ydCBieSByZXN0YXVyYW50IElEXG5cdFx0XHRcdC8vIHJlc3BvbnNlSnNvbi5zb3J0KChhLGIpID0+IGEucmVzdGF1cmFudF9pZCAtIGIucmVzdGF1cmFudF9pZCk7XG5cblx0XHRcdFx0Ly8gQWRkIFJldmlld3MgaW4gSW5kZXhEQiBpZiBub3QgYWRkZWQgYmVmb3JlXG5cdFx0XHRcdGlmIChyZXZpZXdzRmV0Y2hTdGF0dXMgIT0gMSkge1xuXHRcdFx0XHRcdHJldmlld3NGZXRjaFN0YXR1cyA9IDE7XG5cdFx0XHRcdFx0cmVzcG9uc2VKc29uLmZvckVhY2gocmVzdGF1cmFudERhdGEgPT4ge1xuXHRcdFx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5hZGRUb0RiKFxuXHRcdFx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0XHRcdG9iamVjdFN0b3JlTmFtZSxcblx0XHRcdFx0XHRcdFx0cGVybWlzaW9uLFxuXHRcdFx0XHRcdFx0XHRyZXN0YXVyYW50RGF0YVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYWxsYmFjayAobnVsbCwgcmVzcG9uc2VKc29uKTtcblx0XHRcdH0pLmNhdGNoKGVycm9yID0+IHtcblx0XHRcdFx0Y2FsbGJhY2sgKGVycm9yLCBudWxsKTtcblx0XHRcdH0pO1xuXHR9XG5cblx0c3RhdGljIGdldFJldmlld3NEYXRhKGNhbGxiYWNrKSB7XG5cdFx0dmFyIGlkYk5hbWUgPSAncmV2aWV3cy1kYXRhJztcblx0XHR2YXIgZGJWZXJzaW9uID0gREJfVkVSU0lPTjtcblx0XHR2YXIgb2JqZWN0U3RvcmVOYW1lU3RyaW5nID0gJ3Jldmlld3MnO1xuXHRcdHZhciB0cmFuc2FjdGlvbk5hbWVTdHJpbmcgPSAncmV2aWV3cyc7XG5cdFx0dmFyIGRiUGVybWlzc2lvbiA9ICdyZWFkd3JpdGUnO1xuXG5cdFx0dmFyIGRiUHJvbWlzZSA9IElEYk9wZXJhdGlvbnNIZWxwZXIub3BlbklEYihcblx0XHRcdGlkYk5hbWUsXG5cdFx0XHRkYlZlcnNpb24sXG5cdFx0XHRvYmplY3RTdG9yZU5hbWVTdHJpbmdcblx0XHQpO1xuXG5cdFx0ZGJQcm9taXNlLnRoZW4oZGIgPT5cblx0XHRcdGRiLnRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uTmFtZVN0cmluZywgZGJQZXJtaXNzaW9uKVxuXHRcdFx0XHQub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lU3RyaW5nKVxuXHRcdFx0XHQuZ2V0QWxsKClcblx0XHQpLnRoZW4ocmVzcG9uc2VPYmVqY3RzID0+IHtcblx0XHRcdGlmIChyZXNwb25zZU9iZWpjdHMubGVuZ3RoIDw9IDApIHtcblx0XHRcdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXZpZXdzRnJvbVNlcnZlcihcblx0XHRcdFx0XHRkYlByb21pc2UsXG5cdFx0XHRcdFx0b2JqZWN0U3RvcmVOYW1lU3RyaW5nLFxuXHRcdFx0XHRcdGRiUGVybWlzc2lvbixcblx0XHRcdFx0XHRjYWxsYmFja1xuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzcG9uc2VPYmVqY3RzKTtcblx0XHRcdH1cblx0XHR9KS5jYXRjaChlcnIgPT4ge1xuXHRcdFx0Y2FsbGJhY2soZXJyLCBudWxsKTtcblx0XHR9KTtcblx0fVxuXG5cdC8vIEFkZCByZXZpZXcgZGF0YSBpbiBpbmRleERCXG5cdHN0YXRpYyBhZGRSZXZpZXdUb0lkYihyZXZpZXdEYXRhKSB7XG5cdFx0dmFyIGlkYk5hbWUgPSAncmV2aWV3cy1kYXRhJztcblx0XHR2YXIgZGJWZXJzaW9uID0gREJfVkVSU0lPTjtcblx0XHR2YXIgb2JqZWN0U3RvcmVOYW1lID0gJ3Jldmlld3MnO1xuXHRcdHZhciB0cmFuc2FjdGlvbk5hbWUgPSAncmV2aWV3cyc7XG5cdFx0dmFyIGRiUGVybWlzc2lvbiA9ICdyZWFkd3JpdGUnO1xuXG5cdFx0dmFyIGRiUHJvbWlzZSA9IElEYk9wZXJhdGlvbnNIZWxwZXIub3BlbklEYihcblx0XHRcdGlkYk5hbWUsXG5cdFx0XHRkYlZlcnNpb24sXG5cdFx0XHRvYmplY3RTdG9yZU5hbWVcblx0XHQpO1xuXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5hZGRUb0RiKFxuXHRcdFx0ZGJQcm9taXNlLFxuXHRcdFx0b2JqZWN0U3RvcmVOYW1lLFxuXHRcdFx0ZGJQZXJtaXNzaW9uLFxuXHRcdFx0cmV2aWV3RGF0YVxuXHRcdCk7XG5cdH1cblxufVxuIiwiLy8gQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXG5jbGFzcyBEQkhlbHBlciB7XG5cdHN0YXRpYyBnZXQgTkVXX1VSTCgpIHtcblx0XHRyZXR1cm4gJ2h0dHA6Ly9sb2NhbGhvc3Q6MTMzNy9yZXN0YXVyYW50cyc7XG5cdH1cblx0LyoqXG4gICAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cbiAgICAgKi9cblx0c3RhdGljIGZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIGNhbGxiYWNrKSB7XG5cdFx0Ly8gZmV0Y2ggYWxsIHJlc3RhdXJhbnRzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHRcdElEYk9wZXJhdGlvbnNIZWxwZXIuZ2V0UmVzdGF1cmFudHNEYXRhKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zdCByZXN0YXVyYW50ID0gcmVzdGF1cmFudHMuZmluZChyID0+IHIuaWQgPT0gaWQpO1xuXHRcdFx0XHRpZiAocmVzdGF1cmFudCkge1xuXHRcdFx0XHRcdC8vIEdvdCB0aGUgcmVzdGF1cmFudFxuXHRcdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXG5cdFx0XHRcdFx0Y2FsbGJhY2soJ1Jlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QnLCBudWxsKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG4gICAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIHR5cGUgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG4gICAgICovXG5cdHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSwgY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXG5cdFx0XHRcdGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAgICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICAgKi9cblx0c3RhdGljIGZldGNoUmVzdGF1cmFudEJ5TmVpZ2hib3Job29kKG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2Rcblx0XHRcdFx0Y29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG4gICAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIGFuZCBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICAgKi9cblx0c3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChcblx0XHRjdWlzaW5lLFxuXHRcdG5laWdoYm9yaG9vZCxcblx0XHRjYWxsYmFja1xuXHQpIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bGV0IHJlc3VsdHMgPSByZXN0YXVyYW50cztcblx0XHRcdFx0aWYgKGN1aXNpbmUgIT0gJ2FsbCcpIHtcblx0XHRcdFx0XHQvLyBmaWx0ZXIgYnkgY3Vpc2luZVxuXHRcdFx0XHRcdHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHtcblx0XHRcdFx0XHQvLyBmaWx0ZXIgYnkgbmVpZ2hib3Job29kXG5cdFx0XHRcdFx0cmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuICAgICAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuICAgICAqL1xuXHRzdGF0aWMgZmV0Y2hOZWlnaGJvcmhvb2RzKGNhbGxiYWNrKSB7XG5cdFx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xuXHRcdFx0XHRjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzdGF1cmFudHMubWFwKFxuXHRcdFx0XHRcdCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5uZWlnaGJvcmhvb2Rcblx0XHRcdFx0KTtcblx0XHRcdFx0Ly8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBuZWlnaGJvcmhvb2RzXG5cdFx0XHRcdGNvbnN0IHVuaXF1ZU5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzLmZpbHRlcihcblx0XHRcdFx0XHQodiwgaSkgPT4gbmVpZ2hib3Job29kcy5pbmRleE9mKHYpID09IGlcblx0XHRcdFx0KTtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgdW5pcXVlTmVpZ2hib3Job29kcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAgICAgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG4gICAgICovXG5cdHN0YXRpYyBmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XG5cdFx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG5cdFx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEdldCBhbGwgY3Vpc2luZXMgZnJvbSBhbGwgcmVzdGF1cmFudHNcblx0XHRcdFx0Y29uc3QgY3Vpc2luZXMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLmN1aXNpbmVfdHlwZSk7XG5cdFx0XHRcdC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcblx0XHRcdFx0Y29uc3QgdW5pcXVlQ3Vpc2luZXMgPSBjdWlzaW5lcy5maWx0ZXIoXG5cdFx0XHRcdFx0KHYsIGkpID0+IGN1aXNpbmVzLmluZGV4T2YodikgPT0gaVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCB1bmlxdWVDdWlzaW5lcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAgICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxuICAgICAqL1xuXHRzdGF0aWMgdXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XG5cdFx0cmV0dXJuIGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YDtcblx0fVxuXG5cdC8qKlxuICAgICAqIFJlc3RhdXJhbnQgaW1hZ2UgVVJMLlxuICAgICAqL1xuXHRzdGF0aWMgaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcblx0XHRyZXR1cm4gYC9pbWcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGh9LmpwZ2A7XG5cdH1cblxuXHQvKipcbiAgICAgKiBNYXAgbWFya2VyIGZvciBhIHJlc3RhdXJhbnQuXG4gICAgICovXG5cdHN0YXRpYyBtYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1hcCkge1xuXHRcdGNvbnN0IG1hcmtlciA9IG5ldyBMLm1hcmtlcihcblx0XHRcdFtyZXN0YXVyYW50LmxhdGxuZy5sYXQsIHJlc3RhdXJhbnQubGF0bG5nLmxuZ10sXG5cdFx0XHR7XG5cdFx0XHRcdHRpdGxlOiByZXN0YXVyYW50Lm5hbWUsXG5cdFx0XHRcdGFsdDogcmVzdGF1cmFudC5uYW1lLFxuXHRcdFx0XHR1cmw6IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudClcblx0XHRcdH1cblx0XHQpO1xuXHRcdG1hcmtlci5hZGRUbyhuZXdNYXApO1xuXHRcdHJldHVybiBtYXJrZXI7XG5cdH1cblxuXHQvKiBHZXQgcmV2aWV3cyBmb3IgYSByZXN0YXVyYW50Ki9cblx0c3RhdGljIGZldGNoUmV2aWV3c0ZvclJlc3RhdXJhbnQocmVzdGF1cmFudF9pZCwgY2FsbGJhY2spIHtcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJldmlld3NEYXRhKChlcnJvciwgYWxsUmV2aWV3cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGxldCByZXZpZXdzID0gYWxsUmV2aWV3cy5maWx0ZXIociA9PiByLnJlc3RhdXJhbnRfaWQgPT0gcmVzdGF1cmFudF9pZCk7XG5cdFx0XHRcdGlmIChyZXZpZXdzKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmV2aWV3cyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2soJ1JldmlldyBkb2VzIG5vdCBleGlzdCcsIG51bGwpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKiBBZGQgbmV3IHJldmlldyBmb3IgYSByZXN0YXVyYW50Ki9cblx0c3RhdGljIGFkZFJldmlld0ZvclJlc3RhdXJhbnQocmV2aWV3RGF0YSwgY2FsbGJhY2spIHtcblx0XHRJRGJPcGVyYXRpb25zSGVscGVyLmFkZFJldmlld1RvSWRiKHJldmlld0RhdGEpO1xuXHRcdGNhbGxiYWNrKCdSZXZpZXcgYWRkZWQgdG8gSURCJyk7XG5cdH1cblxuXG59XG4iXSwiZmlsZSI6ImFwcC1taW4uanMifQ==
