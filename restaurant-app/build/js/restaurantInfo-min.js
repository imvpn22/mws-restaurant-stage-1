var newMap;document.addEventListener("DOMContentLoaded",e=>{initMap()}),initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiaW12cG4yMiIsImEiOiJjaml2bnlycGExM3FuM3FxbTc0eWM2NHV2In0.ESs374xN3guFAGO_1EPdmQ",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,a)=>{self.restaurant=a,a?(fillRestaurantHTML(),e(null,a)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML="<i class='fa fa-map-marker'></i>"+e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.src=DBHelper.imageUrlForRestaurant(e),"http://localhost:8080/no-image"==t.src&&t.classList.add("fallback-image-icon"),t.alt=`${e.name} restaurant image`,document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let a in e){const n=document.createElement("tr"),r=document.createElement("td");r.innerHTML=a,n.appendChild(r);const s=document.createElement("td");s.innerHTML=e[a],n.appendChild(s),t.appendChild(n)}}),fillReviewsHTML=((e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),a=document.createElement("h2");if(a.innerHTML="Reviews",a.setAttribute("tabindex",0),t.appendChild(a),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",e.setAttribute("tabindex",0),void t.appendChild(e)}const n=document.getElementById("reviews-list");e.forEach(e=>{n.appendChild(createReviewHTML(e))}),t.appendChild(n)}),createReviewHTML=(e=>{const t=document.createElement("li");t.setAttribute("tabindex",0);const a=document.createElement("p");a.className="review-user",a.innerHTML="<i class='fa fa-user'></i>"+e.name,a.setAttribute("tabindex",0),t.appendChild(a);const n=document.createElement("p");n.className="review-date",n.innerHTML="<i class='fa fa-calendar'></i>"+e.date,n.setAttribute("tabindex",0),t.appendChild(n);const r=document.createElement("p");for(r.className="review-rating",r.innerHTML="",r.setAttribute("tabindex",0),r.setAttribute("aria-label",`Rating: ${e.rating} out of 5 stars`),i=0;i<e.rating;i++){let e=document.createElement("i");e.className="fa fa-star",r.appendChild(e)}for(i=e.rating;i<5;i++){let e=document.createElement("i");e.className="far fa-star",r.appendChild(e)}t.appendChild(r);const s=document.createElement("p");return s.className="review-comments",s.innerHTML=e.comments,s.setAttribute("tabindex",0),t.appendChild(s),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),a=document.createElement("li");a.innerHTML=e.name,t.appendChild(a)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const a=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRJbmZvLmpzIl0sIm5hbWVzIjpbIm5ld01hcCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiaW5pdE1hcCIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJlcnJvciIsInJlc3RhdXJhbnQiLCJjb25zb2xlIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiYXR0cmlidXRpb24iLCJpZCIsImFkZFRvIiwiZmlsbEJyZWFkY3J1bWIiLCJEQkhlbHBlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJjYWxsYmFjayIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsIm5hbWUiLCJhZGRyZXNzIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhbHQiLCJjdWlzaW5lX3R5cGUiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiaG91cnMiLCJrZXkiLCJyb3ciLCJjcmVhdGVFbGVtZW50IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwicmV2aWV3cyIsImNvbnRhaW5lciIsInRpdGxlIiwic2V0QXR0cmlidXRlIiwibm9SZXZpZXdzIiwidWwiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsImxpIiwiZGF0ZSIsInJhdGluZyIsImkiLCJzdGFyIiwiY29tbWVudHMiLCJicmVhZGNydW1iIiwidXJsIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwicmVw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QU1DLE9BQU9DLFNBQVNDLE1BQ3ZCeEMsRUFBT0EsRUFBS3lDLFFBQVEsVUFBVyxRQUMvQixNQUNBQyxFQURjLElBQUlDLGNBQWMzQyxzQkFDaEI0QyxLQUFLUCxHQUNyQixPQUFLSyxFQUVBQSxFQUFRLEdBRU5HLG1CQUFtQkgsRUFBUSxHQUFHRCxRQUFRLE1BQU8sTUFENUMsR0FGQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIHZhciByZXN0YXVyYW50O1xudmFyIG5ld01hcDtcblxuLyoqXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIChldmVudCkgPT4ge1xuXHRpbml0TWFwKCk7XG59KTtcblxuLyoqXG4gKiBJbml0aWFsaXplIGxlYWZsZXQgbWFwXG4gKi9cbmluaXRNYXAgPSAoKSA9PiB7XG5cdGZldGNoUmVzdGF1cmFudEZyb21VUkwoKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG5cdFx0aWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XG5cdFx0XHRcdGNlbnRlcjogW3Jlc3RhdXJhbnQubGF0bG5nLmxhdCwgcmVzdGF1cmFudC5sYXRsbmcubG5nXSxcblx0XHRcdFx0em9vbTogMTYsXG5cdFx0XHRcdHNjcm9sbFdoZWVsWm9vbTogZmFsc2Vcblx0XHRcdH0pO1xuXHRcdFx0TC50aWxlTGF5ZXIoJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsIHtcblx0XHRcdFx0bWFwYm94VG9rZW46ICdway5leUoxSWpvaWFXMTJjRzR5TWlJc0ltRWlPaUpqYW1sMmJubHljR0V4TTNGdU0zRnhiVGMwZVdNMk5IVjJJbjAuRVNzMzc0eE4zZ3VGQUdPXzFFUGRtUScsXG5cdFx0XHRcdG1heFpvb206IDE4LFxuXHRcdFx0XHRhdHRyaWJ1dGlvbjogJ01hcCBkYXRhICZjb3B5OyA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvXCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzLCAnICtcblx0XHRcdFx0JzxhIGhyZWY9XCJodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvMi4wL1wiPkNDLUJZLVNBPC9hPiwgJyArXG5cdFx0XHRcdCdJbWFnZXJ5IMKpIDxhIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiPk1hcGJveDwvYT4nLFxuXHRcdFx0XHRpZDogJ21hcGJveC5zdHJlZXRzJ1xuXHRcdFx0fSkuYWRkVG8obmV3TWFwKTtcblx0XHRcdGZpbGxCcmVhZGNydW1iKCk7XG5cdFx0XHREQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5uZXdNYXApO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKiB3aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcblx0aWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcblx0ICBjb25zb2xlLmVycm9yKGVycm9yKTtcblx0fSBlbHNlIHtcblx0ICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG5cdFx0em9vbTogMTYsXG5cdFx0Y2VudGVyOiByZXN0YXVyYW50LmxhdGxuZyxcblx0XHRzY3JvbGx3aGVlbDogZmFsc2Vcblx0ICB9KTtcblx0ICBmaWxsQnJlYWRjcnVtYigpO1xuXHQgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm1hcCk7XG5cdH1cbiAgfSk7XG59ICovXG5cbi8qKlxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxuICovXG5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XG5cdGlmIChzZWxmLnJlc3RhdXJhbnQpIHsgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXG5cdFx0Y2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KTtcblx0XHRyZXR1cm47XG5cdH1cblx0Y29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XG5cdGlmICghaWQpIHsgLy8gbm8gaWQgZm91bmQgaW4gVVJMXG5cdFx0ZXJyb3IgPSAnTm8gcmVzdGF1cmFudCBpZCBpbiBVUkwnO1xuXHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0fSBlbHNlIHtcblx0XHREQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcblx0XHRcdHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XG5cdFx0XHRpZiAoIXJlc3RhdXJhbnQpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnJvcik7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGZpbGxSZXN0YXVyYW50SFRNTCgpO1xuXHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XG5cdFx0fSk7XG5cdH1cbn07XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXG4gKi9cbmZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG5cdGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XG5cdG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuXG5cdGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XG5cdGFkZHJlc3MuaW5uZXJIVE1MID0gJzxpIGNsYXNzPVxcJ2ZhIGZhLW1hcC1tYXJrZXJcXCc+PC9pPicgKyByZXN0YXVyYW50LmFkZHJlc3M7XG5cblx0Y29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcblx0aW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcblx0aW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuXHRpZiAoaW1hZ2Uuc3JjID09ICdodHRwOi8vbG9jYWxob3N0OjgwODAvbm8taW1hZ2UnKSB7XG5cdFx0aW1hZ2UuY2xhc3NMaXN0LmFkZCgnZmFsbGJhY2staW1hZ2UtaWNvbicpO1xuXHR9XG5cdGltYWdlLmFsdCA9IGAke3Jlc3RhdXJhbnQubmFtZX0gcmVzdGF1cmFudCBpbWFnZWA7XG5cblx0Y29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcblx0Y3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuXHQvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuXHRpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcblx0XHRmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuXHR9XG5cdC8vIGZpbGwgcmV2aWV3c1xuXHRmaWxsUmV2aWV3c0hUTUwoKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XG5cdGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKTtcblx0Zm9yIChsZXQga2V5IGluIG9wZXJhdGluZ0hvdXJzKSB7XG5cdFx0Y29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcblxuXHRcdGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG5cdFx0ZGF5LmlubmVySFRNTCA9IGtleTtcblx0XHRyb3cuYXBwZW5kQ2hpbGQoZGF5KTtcblxuXHRcdGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuXHRcdHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XTtcblx0XHRyb3cuYXBwZW5kQ2hpbGQodGltZSk7XG5cblx0XHRob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xuXHR9XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xuXHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKTtcblx0Y29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuXHR0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cyc7XG5cdHRpdGxlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcblx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcblxuXHRpZiAoIXJldmlld3MpIHtcblx0XHRjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdFx0bm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xuXHRcdG5vUmV2aWV3cy5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XG5cdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKG5vUmV2aWV3cyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuXHRyZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcblx0XHR1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xuXHR9KTtcblx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3KSA9PiB7XG5cdGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblx0bGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xuXHRjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRuYW1lLmNsYXNzTmFtZSA9ICdyZXZpZXctdXNlcic7XG5cdG5hbWUuaW5uZXJIVE1MID0gJzxpIGNsYXNzPVxcJ2ZhIGZhLXVzZXJcXCc+PC9pPicgKyByZXZpZXcubmFtZTtcblx0bmFtZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XG5cdGxpLmFwcGVuZENoaWxkKG5hbWUpO1xuXG5cdGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdGRhdGUuY2xhc3NOYW1lID0gJ3Jldmlldy1kYXRlJztcblx0ZGF0ZS5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XFwnZmEgZmEtY2FsZW5kYXJcXCc+PC9pPicgKyByZXZpZXcuZGF0ZTtcblx0ZGF0ZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XG5cdGxpLmFwcGVuZENoaWxkKGRhdGUpO1xuXG5cdGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0cmF0aW5nLmNsYXNzTmFtZSA9ICdyZXZpZXctcmF0aW5nJztcblx0Ly8gcmF0aW5nLmlubmVySFRNTCA9IGA8aSBjbGFzcz0nZmEgZmEtc3Rhcic+PC9pPlJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XG5cdHJhdGluZy5pbm5lckhUTUwgPSAnJztcblx0cmF0aW5nLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcblx0cmF0aW5nLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ30gb3V0IG9mIDUgc3RhcnNgKTtcblxuXHQvLyBGaWxsZWQgc3RhciBmb3IgcmF0aW5nXG5cdGZvciAoaT0wOyBpPHJldmlldy5yYXRpbmc7IGkrKykge1xuXHRcdGxldCBzdGFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xuXHRcdHN0YXIuY2xhc3NOYW1lID0gJ2ZhIGZhLXN0YXInO1xuXHRcdHJhdGluZy5hcHBlbmRDaGlsZChzdGFyKTtcblx0fVxuXHRmb3IgKGk9cmV2aWV3LnJhdGluZzsgaTw1OyBpKyspIHtcblx0XHRsZXQgc3RhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcblx0XHRzdGFyLmNsYXNzTmFtZSA9ICdmYXIgZmEtc3Rhcic7XG5cdFx0cmF0aW5nLmFwcGVuZENoaWxkKHN0YXIpO1xuXHR9XG5cdGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XG5cblx0Y29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdGNvbW1lbnRzLmNsYXNzTmFtZSA9ICdyZXZpZXctY29tbWVudHMnO1xuXHRjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XG5cdGNvbW1lbnRzLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcblx0bGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xuXG5cdHJldHVybiBsaTtcbn07XG5cbi8qKlxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcbiAqL1xuZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudD1zZWxmLnJlc3RhdXJhbnQpID0+IHtcblx0Y29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG5cdGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblx0bGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuXHRicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcbn07XG5cbi8qKlxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cbiAqL1xuZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xuXHRpZiAoIXVybClcblx0XHR1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcblx0bmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xuXHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcblx0cmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcblx0aWYgKCFyZXN1bHRzKVxuXHRcdHJldHVybiBudWxsO1xuXHRpZiAoIXJlc3VsdHNbMl0pXG5cdFx0cmV0dXJuICcnO1xuXHRyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMl0ucmVwbGFjZSgvXFwrL2csICcgJykpO1xufTtcbiJdLCJmaWxlIjoicmVzdGF1cmFudEluZm8tbWluLmpzIn0=
